{% extends "GovWikiAdminBundle:Layout:wizard.html.twig" %}

{% block panel_title %}
    Create map
{% endblock panel_title %}

{% block breadcrumb %}
    <li><a href="{{ path('step1') }}">Setup environment</a></li>
    <li><a href="{{ path('step2') }}">Setup map</a></li>
    <li class="active">Create map</li>
{% endblock breadcrumb %}

{% block content %}
    <p class="text-center">Creating map ...</p>
    <div class="loader"></div>
{% endblock content %}

{% block javascripts %}
    {{ parent() }}
    <script>
        $(function(){
            /*
                Check map importing process.
             */
            var check = setInterval(function() {
                $.ajax({
                    url: '{{ govwiki_path('govwiki_admin_wizard_import', {
                        item_queue_id: itemQueueId
                    }) }}'
                }).done(function(data) {
                    console.log(data);
                    if (data && (data.success === true) && (data.state === 'complete')) {
                        clearInterval(check);
                        window.location = '{{ next }}?item_queue_id=' + data.queue_id;
                    }
                });
            }, 2000);
        });
    </script>
{% endblock javascripts %}