!function e(t,n,a){function i(r,s){if(!n[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(o)return o(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){var n=t[r][1][e];return i(n?n:e)},u,u.exports,e,t,n,a)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<a.length;r++)i(a[r]);return i}({1:[function(e,t){var n,a,i,o,r,s,l,c,u,d,p=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};a=void 0,l=new GMaps({el:"#govmap",lat:37.3,lng:-119.3,zoom:6,minZoom:6,scrollwheel:!0,mapTypeControl:!1,panControl:!1,mapTypeControl:!1,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}}),l.map.controls[google.maps.ControlPosition.RIGHT_TOP].push(document.getElementById("legend")),d=function(){var e,t,a,i,o;for(i=GOVWIKI.markers,o=[],e=0,t=i.length;t>e;e++)a=i[e],o.push(n(a));return o},u=function(){var e;return e=["City","School District","Special District"],GOVWIKI.gov_type_filter_2=[],$(".type_filter").each(function(t,n){var a;return a=$(n).attr("name"),p.call(e,a)>=0&&"1"===$(n).val()?GOVWIKI.gov_type_filter_2.push($(n).attr("name")):void 0})},r=function(e,t){return $.ajax({url:"http://45.55.0.145/api/government/get-markers-data?limit=600",data:{altTypes:e},dataType:"json",cache:!0,success:t,error:function(e){return console.log(e)}})},$(function(){return u(),r(GOVWIKI.gov_type_filter_2,function(e){return GOVWIKI.markers=e,d()}),$("#legend li:not(.counties-trigger)").on("click",function(){var e,t;return $(this).toggleClass("active"),e=$(this).find("input"),t=e.val(),e.val("1"===t?"0":"1"),u(),l.removeMarkers(),d()}),$("#legend li.counties-trigger").on("click",function(){return $(this).toggleClass("active"),$(this).hasClass("active")?GOVWIKI.get_counties(GOVWIKI.draw_polygons):l.removePolygons()})}),o=function(e){var t;switch(t=function(e){return{path:google.maps.SymbolPath.CIRCLE,fillOpacity:1,fillColor:e,strokeWeight:1,strokeColor:"white",scale:6}},e){case"City":return t("red");case"School District":return t("lightblue");case"Special District":return t("purple");default:return t("white")}},s=function(e,t){var n,a,i;for(n=0,i=t.length;i>n;n++)if(a=t[n],a===e)return!0;return!1},n=function(e){var t;return t=s(e.altType,GOVWIKI.gov_type_filter_2),t===!1?!1:l.addMarker({lat:e.latitude,lng:e.longitude,icon:o(e.altType),title:e.name+", "+e.type,infoWindow:{content:"<div><a href='javascript:void(0);' class='info-window-uri' data-uri='/"+e.altTypeSlug+"/"+e.slug+"'><strong>"+e.name+"</strong></a></div> <div> "+e.type+"  "+e.city+" "+e.zip+" "+e.state+"</div>"}})},c=new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=Z|7777BB|FFFFFF",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34)),i=function(e,t){return GMaps.geocode({address:e,callback:function(e,n){var a;"OK"===n&&(a=e[0].geometry.location,l.setCenter(a.lat(),a.lng()),l.addMarker({lat:a.lat(),lng:a.lng(),size:"small",title:e[0].formatted_address,infoWindow:{content:e[0].formatted_address}}),t&&l.addMarker({lat:t.latitude,lng:t.longitude,size:"small",color:"blue",icon:c,title:t.latitude+" "+t.longitude,infoWindow:{content:t.latitude+" "+t.longitude}}),$(".govmap-found").html("<strong>FOUND: </strong>"+e[0].formatted_address))}})},t.exports={map:l}},{}],2:[function(e,t){var n,a,i=function(e,t){return function(){return e.apply(t,arguments)}};a=e("./querymatcher.coffee"),n=function(){function e(e,t,n){this.html_selector=e,this.num_items=n,this.startSuggestion=i(this.startSuggestion,this),$.ajax({url:t,dataType:"json",cache:!0,success:this.startSuggestion})}var t,n;return e.prototype.on_selected=function(){},e.prototype.suggestionTemplate=Handlebars.compile('<div class="sugg-box">\n  <div class="sugg-state">{{{state}}}</div>\n  <div class="sugg-name">{{{gov_name}}}</div>\n  <div class="sugg-type">{{{gov_type}}}</div>\n</div>'),t="",n=[],e.prototype.count_govs=function(){var e,t,n,a,i;for(e=0,i=this.govs_array,n=0,a=i.length;a>n;n++)t=i[n],GOVWIKI.state_filter&&t.state!==GOVWIKI.state_filter||GOVWIKI.gov_type_filter&&t.gov_type!==GOVWIKI.gov_type_filter||e++;return e},e.prototype.startSuggestion=function(e){this.govs_array=e.record,$(".typeahead").keyup(function(e){return function(t){return e.entered_value=$(t.target).val()}}(this)),setTimeout(function(e){return function(){return $(e.html_selector).attr("placeholder","GOVERNMENT NAME")}}(this),1e3),$(this.html_selector).typeahead({hint:!1,highlight:!1,minLength:1,classNames:{menu:"tt-dropdown-menu"}},{name:"gov_name",displayKey:"gov_name",source:a(this.govs_array,this.num_items),templates:{suggestion:this.suggestionTemplate}}).on("typeahead:selected",function(e){return function(t,n,a){return $(".typeahead").typeahead("val",e.entered_value),e.on_selected(t,n,a)}}(this)).on("typeahead:cursorchanged",function(e){return function(){return $(".typeahead").val(e.entered_value)}}(this))},e}(),t.exports=n},{"./querymatcher.coffee":4}],3:[function(e){var t,n,a,i,o,r,s,l,c,u,d,p,h,f,g,m,v,_,y,w,b,C,k,x,T,I;t=e("./govselector.coffee"),n=e("./templates2.coffee"),I=e("./wikipedia.coffee"),v=null,m=null,x=new n,i="",T=null,r=!1,Handlebars.registerHelper("if_eq",function(e,t,n){return e==t?n.fn(this):n.inverse(this)}),window.GOVWIKI={state_filter:"",gov_type_filter:"",gov_type_filter_2:["City","School District","Special District"],show_search_page:function(){return $("#dataContainer").hide(),$("#searchIcon").hide(),$("#searchContainer").fadeIn(300),u(500)},show_data_page:function(){return $("#searchIcon").show(),$("#dataContainer").fadeIn(300),$("#searchContainer").hide()}},GOVWIKI.get_counties=d=function(e){return $.ajax({url:"/legacy/data/county_geography_ca_2.json",dataType:"json",cache:!0,success:function(t){return e(t)}})},GOVWIKI.draw_polygons=c=function(e){var t,n,a,i,o;for(i=e.features,o=[],n=0,a=i.length;a>n;n++)t=i[n],o.push(function(){return function(e){return v.map.drawPolygon({paths:e.geometry.coordinates,useGeoJSON:!0,strokeColor:"#808080",strokeOpacity:.6,strokeWeight:1.5,fillColor:"#FF0000",fillOpacity:.15,countyId:e.properties._id,altName:e.properties.alt_name,marker:new MarkerWithLabel({position:new google.maps.LatLng(0,0),draggable:!1,raiseOnDrag:!1,map:v.map.map,labelContent:e.properties.name,labelAnchor:new google.maps.Point(-15,25),labelClass:"label-tooltip",labelStyle:{opacity:1},icon:"http://placehold.it/1x1",visible:!1}),mouseover:function(){return this.setOptions({fillColor:"#00FF00"})},mousemove:function(e){return this.marker.setPosition(e.latLng),this.marker.setVisible(!0)},mouseout:function(){return this.setOptions({fillColor:"#FF0000"}),this.marker.setVisible(!1)},click:function(){var t;return $(".loader").show(),$("#searchContainer").hide(),$("#dataContainer").show(),t="/"+e.alt_type_slug+"/"+e.properties.slug,$.ajax({url:"http://45.55.0.145/api/government"+t,dataType:"json",cache:!0,success:function(e){var n;return n=x.get_html(0,e),$("#details").html(n),$(".loader").hide(),$("#details").show(),$("#searchIcon").show(),window.history.pushState({template:n},"CPC Civic Profiles",t)}})}})}}(this)(t));return o},window.remember_tab=function(e){return i=e},$(document).on("click","#fieldTabs a",function(e){var t,n,a;return i=$(e.currentTarget).data("tabname"),console.log(i),$("#tabsContent .tab-pane").removeClass("active"),$($(e.currentTarget).attr("href")).addClass("active"),x.activate(0,i),"Financial Statements"===i?(t=0,n=0,a=0,$('.fin-values-block [data-col="1"]').find(".fin-val").each(function(){var e;return e=$(this).width(),e>t?t=e:void 0}),$('.fin-values-block [data-col="2"]').find(".fin-val").each(function(){var e;return e=$(this).width(),e>n?n=e:void 0}),$('.fin-values-block [data-col="3"]').find(".fin-val").each(function(){var e;return e=$(this).width(),e>a?a=e:void 0}),$('.fin-values-block [data-col="1"] .currency-sign').css("right",t+27),$('.fin-values-block [data-col="2"] .currency-sign').css("right",n+27),$('.fin-values-block [data-col="3"] .currency-sign').css("right",a+27)):void 0}),$(document).tooltip({selector:"[class='media-tooltip']",trigger:"click"}),a=function(){return $("#fieldTabs a[href='#tab"+i+"']").tab("show")},g=function(e){return $("#wikipediaContainer").html(""),$.ajax({url:"http://46.101.3.79:80/rest/db/govs/"+e,dataType:"json",headers:{"X-DreamFactory-Application-Name":"govwiki"},cache:!0,success:function(e){e&&h(e._id,function(t){return e.financial_statements=t,p(e._id,25,function(t){return e.elected_officials=t,f(function(t){return e.max_ranks=t.record[0],a()})})})},error:function(e){return console.log(e)}})},p=function(e,t,n){return $.ajax({url:"http://46.101.3.79/api/government/"+e+"/"+t,dataType:"json",cache:!0,success:n,error:function(e){return console.log(e)}})},h=function(e,t){return $.ajax({url:"http://46.101.3.79:80/rest/db/_proc/get_financial_statements",data:{app_name:"govwiki",order:"caption_category,display_order",params:[{name:"govs_id",param_type:"IN",value:e}]},dataType:"json",cache:!0,success:t,error:function(e){return console.log(e)}})},f=function(e){return $.ajax({url:"http://46.101.3.79:80/rest/db/max_ranks",data:{app_name:"govwiki"},dataType:"json",cache:!0,success:e})},window.GOVWIKI.show_record=function(){return function(e){return $("#details").html(x.get_html(0,e)),a(),GOVWIKI.show_data_page(),router.navigate(e._id)}}(this),window.GOVWIKI.show_record2=function(){return function(e){return p(e.altTypeSlug,e.slug,function(t){var n;return e.elected_officials=t,$("#details").html(x.get_html(0,e)),a(),GOVWIKI.show_data_page(),n=e.altTypeSlug+"/"+e.slug,document.location.pathname=n})}}(this),l=function(e,t,n,a){return $.ajax({url:"https://api.mongolab.com/api/1/databases/govwiki/runCommand?apiKey=0Y5X_Qk2uOJRdHJWJKSRWk6l6JqVTS2y",type:"POST",contentType:"application/json",dataType:"json",data:n,cache:!0,success:function(){return function(n){var i;i=n.values,s(e,t,i.sort(),a)}}(this),error:function(e){return console.log(e)}})},s=function(e,t,n,a){var i,o,r,s,l;for(r="<select class='form-control' style='maxwidth:160px;'><option value=''>"+t+"</option>",i=0,o=n.length;o>i;i++)l=n[i],l&&(r+="<option value='"+l+"'>"+l+"</option>");return r+="</select>",s=$(r),$(e).append(s),"State.."===t&&(s.val("CA"),window.GOVWIKI.state_filter="CA"),s.change(function(e){var t;return t=$(e.target),window.GOVWIKI[a]=t.val(),$(".gov-counter").text(m.count_govs())})},o=function(){var e,t;return e=$("#myinput"),t=$("#typeahed-container"),e.width(t.width())},k=function(){return $(window).resize(function(){return o()})},u=function(e){return setTimeout(function(){return $("#myinput").focus()},e)},window.onhashchange=function(){var e;return e=window.location.hash,e?void 0:GOVWIKI.show_search_page()},w=document.location.pathname.split("/").filter(function(e){return""!==e?e:!1}),b=w.length,GOVWIKI.history=function(e){var t;return 0===e?(t=$("#searchContainer").text(),""!==t?(window.history.pushState({},"CPC Civic Profiles","/"),$("#searchIcon").hide(),$("#stantonIcon").hide()):document.location.pathname="/",$("#details").hide(),$("#searchContainer").show(),!1):null!==history.state&&void 0!==history.state.template?window.history.go(e):(w.pop(),document.location.pathname="/"+w.join("/"))},window.addEventListener("popstate",function(e){return console.log(window.history.state),null!==window.history.state?($("#details").html(e.state.template),w=document.location.pathname.split("/").length-1,2===w&&$("#stantonIcon").hide(),1===w&&$("#searchContainer").show(),GOVWIKI.show_data_page()):GOVWIKI.show_search_page()}),y=function(e,t,n){return DISQUS.reset({reload:!0,config:function(){return this.page.identifier=e,this.page.url=t,this.page.title=n}})},C=function(e,t){var n,a,i,o,r;return o=$(e+" tbody  [data-id]").get(),a=$(e+" tbody  tr:last").get(),n=$(e+" tbody tr:first").children("th").eq(t),i=!0,n.hasClass("desc")?(n.removeClass("desc").addClass("origin"),o=n.data("origin"),i=!1):n.hasClass("asc")?(n.removeClass("asc").addClass("desc"),r=function(e,n){var a,i;return a=$(e).children("td").eq(t).text().toUpperCase(),i=$(n).children("td").eq(t).text().toUpperCase(),i>a?1:a>i?-1:0}):n.hasClass("origin")?(n.addClass("asc"),r=function(e,n){var a,i;return a=$(e).children("td").eq(t).text().toUpperCase(),i=$(n).children("td").eq(t).text().toUpperCase(),i>a?-1:a>i?1:0}):(n.addClass("asc"),n.data("origin",o.slice(0)),r=function(e,n){var a,i;return a=$(e).children("td").eq(t).text().toUpperCase(),i=$(n).children("td").eq(t).text().toUpperCase(),i>a?-1:a>i?1:0}),i&&o.sort(r),$.each(o,function(t,n){return $(e).children("tbody").append(n)}),$(e).children("tbody").append(a)},_=function(e){return $('[data-toggle="tooltip"]').tooltip(),$(".editable").editable({stylesheets:!1,type:"textarea",showbuttons:"bottom",display:!0,emptytext:" "}),$(".editable").off("click"),$("table").on("click",".glyphicon-pencil",function(e){return e.preventDefault(),e.stopPropagation(),void 0===e.currentTarget.dataset.noEditable?r?$(e.currentTarget).closest("td").find(".editable").editable("toggle"):$.ajax("/editrequest/new",{method:"POST",complete:function(t){return 401===t.status?showModal("/login"):200===t.status?(r=!0,$(e.currentTarget).closest("td").find(".editable").editable("toggle")):void 0},error:function(e){return 401===e.status?showModal("/login"):void 0}}):void 0}),$(".sort").on("click",function(e){var t;return e.preventDefault(),e.stopPropagation(),t=$(this).attr("data-sort-type"),"year"===t?C('[data-entity-type="Contribution"]',0):"name"===t?C('[data-entity-type="Contribution"]',1):"amount"===t?C('[data-entity-type="Contribution"]',3):void 0}),$("a").on("save",function(e,t){var n,a,i,o;return n=$(e.currentTarget).closest("table")[0].dataset.entityType,i=$(e.currentTarget).closest("tr")[0].dataset.id,a=Object.keys($(e.currentTarget).closest("td")[0].dataset)[0],o={editRequest:{entityName:n,entityId:i,changes:{}}},o.editRequest.changes[a]=t.newValue,o.editRequest=JSON.stringify(o.editRequest),console.log(o),$.ajax("/editrequest/create",{method:"POST",data:o,dataType:"text/json",success:function(e){var t;return t=JSON.parse(e.responseText)},error:function(e){return 401===e.status?showModal("/login"):void 0}})}),$("table").on("click",".add",function(t){var n,a,i,o;return i=$(t.target).closest(".tab-pane"),o=i[0].id,r?(n=null,console.log(o),"Votes"===o?(n="Legislation",$("#addVotes").modal("toggle").find("form")[0].reset()):"Contributions"===o?(n="Contribution",$("#addContributions").modal("toggle").find("form")[0].reset()):"Endorsements"===o?(n="Endorsement",$("#addEndorsements").modal("toggle").find("form")[0].reset()):"Statements"===o&&(n="PublicStatement",$("#addStatements").modal("toggle").find("form")[0].reset()),i.hasClass("loaded")?!1:(i[0].classList.add("loaded"),a={createRequest:{entityName:n,knownFields:{electedOfficial:e.id}}},$.ajax({method:"POST",url:"/api/createrequest/new",data:a,success:function(e){var t,a,i,o;if(console.log(e),a={},e.choices[0].choices.forEach(function(e){var t;return t=Object.keys(e),t.forEach(function(t){return a[t]=e[t]})}),i=function(){var t,n,i;o.setAttribute("name",e.choices[0].name),i=[];for(t in a)n=document.createElement("option"),n.setAttribute("value",t),n.textContent=a[t],i.push(o.innerHTML+=n.outerHTML);return i},o=null,"Endorsement"===n);else if("Contribution"===n);else{if("Legislation"===n)return o=$("#addVotes select")[0],i(),$("#addVotes").find('[data-provide="datepicker"]').on("changeDate",function(){return $(this).datepicker("hide")}),t=Handlebars.compile($("#legislation-vote").html()),$("#electedVotes").html(t(e));if("PublicStatement"===n)return o=$("#addStatements select")[0],i(),$("#addStatements").find('[data-provide="datepicker"]').on("changeDate",function(){return $(this).datepicker("hide")})}},error:function(e){return 401===e.status?showModal("/login"):void 0}}))):($.ajax("/editrequest/new",{method:"POST",complete:function(e){return 401===e.status?showModal("/login"):200===e.status?r=!0:void 0},error:function(e){return 401===e.status?showModal("/login"):void 0}}),!1)}),window.addItem=function(t){var n,a,i,o,r,s,l,c,u,d,p,h,f,g,m,v,_,y,w,b,C,k;p={},u=$(t.target).closest(".modal"),d=u[0].id,r=u[0].dataset.entityType,console.log(r),u.find('input[type="text"]').each(function(e,t){var n;return n=Object.keys(t.dataset)[0],p[n]=t.value}),u.find("textarea").each(function(e,t){var n;return n=Object.keys(t.dataset)[0],p[n]=t.value}),a={},"addVotes"!==d&&(a.electedOfficial=e.id),i=[],"addVotes"===d?(u.find("#electedVotes").find("tr[data-elected]").each(function(e,t){var n,a,o;return t=$(t),a=Object.create(null,{}),t.find("select").each(function(e,t){var n;return t.value?(n=Object.keys(t.dataset)[0],a[n]=t.value):void 0}),2===Object.keys(a).length?(o=Object.create(null,{}),o.fields=a,o.associations=Object.create(null,{}),o.associations[t.attr("data-entity-type")]=t.attr("data-elected"),n=t.parent().parent().attr("data-entity-type"),i.push({entityName:n,fields:o})):void 0}),v=u.find("select")[0],_=v.name,w=v.options[v.selectedIndex].value,y=$(v).find(":selected").text(),a[_]=w):"addContributions"===d||"addEndorsements"===d||"addStatements"===d&&(v=u.find("select")[0],_=v.name,w=v.options[v.selectedIndex].value,y=$(v).find(":selected").text(),a[_]=w),b={createRequest:{entityName:r,fields:{fields:p,associations:a,childs:i}}},C=document.createElement("tr"),f=b.createRequest.fields.fields;for(l in f)k=f[l],C.innerHTML+="<td><a href='javascript:void(0);' class='editable editable-pre-wrapped editable-click'>"+k+"</a></td>";if("addVotes"===d){for(n=!1,o=Object.create(null,{}),console.log(b.createRequest.fields.childs),g=b.createRequest.fields.childs,s=0,c=g.length;c>s;s++)if(h=g[s],Number(h.fields.associations.electedOfficial)===Number(e.id)){n=!0,o=h.fields;break}if(n){m=o.fields;for(l in m)k=m[l],C.innerHTML+="<td><a href='javascript:void(0);' class='editable editable-pre-wrapped editable-click'>"+k+"</a></td>";C.innerHTML+="<td><a href='javascript:void(0);' class='editable editable-pre-wrapped editable-click'>"+y+"</a></td>",$("#Votes tr:last-child").before(C)}}else"addContributions"===d?$("#Contributions tr:last-child").before(C):"addEndorsements"===d&&$("#Endorsements tr:last-child").before(C);return console.log(b),$.ajax({url:"/api/createrequest/create",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:b,success:function(e){return console.log(e)}})}},$("#dataContainer").on("click",".elected_link",function(e){var t;return e.preventDefault(),t=e.currentTarget.pathname,$("#details").hide(),$("#searchContainer").hide(),$("#dataContainer").show(),$("#wikipediaContainer").hide(),$(".loader").show(),$("#stantonIcon").show(),$("#searchIcon").show(),jQuery.get(t,{},function(e){return e?$.ajax({url:"http://45.55.0.145/api/elected-official"+t,dataType:"json",cache:!0,success:function(e){var n,a,i,o,r;return o=e[0],$.isEmptyObject(o)?($(".loader").hide(),$("#details").html("<h2>Sorry. Page not found</h2>"),$("#details").css({textAlign:"center"}),$("#details").show(),$("#dataContainer").show(),!1):(a={year:"numeric",month:"numeric",day:"numeric"},o.votes.forEach(function(e){var t;return t=new Date(e.legislation.date_considered),e.legislation.date_considered=t.toLocaleString("en-US",a)}),r=$("#person-info-template").html(),n=Handlebars.compile(r),$(".loader").hide(),$("#details").show(),i=n(o),window.history.pushState({template:i},"CPC Politician Profiles",t),$("#details").html(i),$("#dataContainer").css({display:"block"}),_(o),$(".vote").on("click",function(e){var t,n;return t=e.currentTarget.id,n=e.currentTarget.dataset.legislationName,void 0===n&&(n=o.full_name),$("#myModalLabel").text(n+" ("+o.gov_alt_name+")"),$("#conversation").modal("show"),y(t,"http://govwiki.us/"+t,n)}),$("#stantonIcon a").text("Return to "+o.gov_alt_name),window.DISQUSWIDGETS.getCount())},error:function(e){return console.log(e)}}):void 0})}),0===b&&($("#stantonIcon").hide(),m=new t(".typeahead","/legacy/data/h_types_ca_2.json",7),m.on_selected=function(e,t){var n;return $("#details").hide(),$("#searchContainer").hide(),$("#dataContainer").show(),$(".loader").show(),$("#wikipediaContainer").hide(),$("#stantonIcon").hide(),n="/"+t.altTypeSlug+"/"+t.slug,jQuery.get(n,{},function(e){return e?$.ajax({url:"http://45.55.0.145/api/government"+n,dataType:"json",cache:!0,success:function(e){var t,i;return i=e,$(".loader").hide(),$("#details").show(),t=x.get_html(0,i),window.history.pushState({template:t},"CPC Civic Profiles",n),$("#details").html(t),a(),GOVWIKI.show_data_page()},error:function(e){return console.log(e)}}):void 0})},T||($("#searchContainer").html($("#search-container-template").html()),$.get("/legacy/texts/intro-text.html",function(e){return $("#intro-text").html(e)}),v=e("./govmap.coffee"),d(GOVWIKI.draw_polygons),T=!0,$(".loader").hide()),o(),k(),$("#btnBackToSearch").click(function(e){return e.preventDefault(),GOVWIKI.show_search_page()}),x.load_fusion_template("tabs","https://www.googleapis.com/fusiontables/v2/query?sql=SELECT%20*%20FROM%201z2oXQEYQ3p2OoMI8V5gKgHWB5Tz990BrQ1xc1tVo&key=AIzaSyCXDQyMDpGA2g3Qjuv4CDv7zRj-ix4IQJA"),$("#govmap").on("click",".info-window-uri",function(e){var t;return t=e.target.parentNode.dataset.uri,$(".loader").show(),$("#searchContainer").hide(),$("#dataContainer").show(),$.ajax({url:"http://45.55.0.145/api/government"+t,dataType:"json",cache:!0,success:function(e){var n;return n=x.get_html(0,e),$("#details").html(n),$(".loader").hide(),$("#details").show(),$("#searchIcon").show(),window.history.pushState({template:n},"CPC Civic Profiles",t)}})})),2===b&&(document.title="CPC Civic Profiles",$("#details").hide(),$("#dataContainer").show(),$(".loader").show(),$("#wikipediaContainer").hide(),$("#stantonIcon").hide(),x.load_fusion_template("tabs","https://www.googleapis.com/fusiontables/v2/query?sql=SELECT%20*%20FROM%201z2oXQEYQ3p2OoMI8V5gKgHWB5Tz990BrQ1xc1tVo&key=AIzaSyCXDQyMDpGA2g3Qjuv4CDv7zRj-ix4IQJA"),$.ajax({url:"http://45.55.0.145/api/government"+window.path,dataType:"json",cache:!0,success:function(e){var t;return t=e,$(".loader").hide(),$("#details").show(),$("#details").html(x.get_html(0,t)),a(),GOVWIKI.show_data_page()},error:function(e){return console.log(e)}}),$("#btnBackToSearch").click(function(e){return e.preventDefault(),GOVWIKI.show_search_page()})),3===b&&(document.title="CPC Politician Profiles",$("#details").hide(),$("#searchContainer").hide(),$("#dataContainer").show(),$("#wikipediaContainer").hide(),$(".loader").show(),$("#stantonIcon").show(),$("#searchIcon").show(),$.ajax({url:"http://45.55.0.145/api/elected-official"+window.path,dataType:"json",success:function(e){var t,n,a,i,o;return i=e[0],$.isEmptyObject(i)?($(".loader").hide(),$("#details").html("<h2>Sorry. Page not found</h2>"),$("#details").css({textAlign:"center"}),$("#details").show(),$("#dataContainer").show(),!1):(n={year:"numeric",month:"numeric",day:"numeric"},void 0!==i.votes&&i.votes.forEach(function(e){var t;return t=new Date(e.legislation.date_considered),e.legislation.date_considered=t.toLocaleString("en-US",n)}),o=$("#person-info-template").html(),t=Handlebars.compile(o),$(".loader").hide(),$("#details").show(),a=t(i),$("#details").html(a),$("#dataContainer").css({display:"block"}),_(i),$(".vote").on("click",function(e){var t,n;return t=e.currentTarget.id,n=e.currentTarget.dataset.legislationName,void 0===n&&(n=i.full_name),$("#myModalLabel").text(n+" ("+i.gov_alt_name+")"),$("#conversation").modal("show"),y(t,"http://govwiki.us/"+t,n)}),$("#stantonIcon a").text("Return to "+i.gov_alt_name),window.DISQUSWIDGETS.getCount())},error:function(e){return console.log(e)}})),$(function(){return $.ajax("/editrequest/new",{method:"POST",complete:function(e){return 401===e.status?r=!1:200===e.status?r=!0:void 0},error:function(e){return 401===e.status?r=!1:void 0}})})},{"./govmap.coffee":1,"./govselector.coffee":2,"./templates2.coffee":5,"./wikipedia.coffee":6}],4:[function(e,t){var n,a,i,o,r,s,l;n=function(e,t){return null==t&&(t=5),function(n,a){var i,s,l,c,u,d,p,h;for(p=function(e,t){var n,a,i;for(n=0,a=t.length;a>n;n++)if(i=t[n],!i.test(e))return!1;return!0},u=o(n),h=u[0],d=u[1],c=[],s=0,l=e.length;l>s&&(i=e[s],!(c.length>=t));s++)GOVWIKI.state_filter&&i.state!==GOVWIKI.state_filter||GOVWIKI.gov_type_filter&&i.gov_type!==GOVWIKI.gov_type_filter||p(i.gov_name,d)&&c.push($.extend({},i));r(c,h,d),a(c)}},r=function(e,t,n){var a,i,o;for(i=0,o=e.length;o>i;i++)a=e[i],a.gov_name=l(a.gov_name,t,n);return e},l=function(e,t,n){return n.forEach(function(n,a){return e=e.replace(n,"<b>"+t[a]+"</b>")}),e},s=function(e){return e.replace(/<[^<>]*>/g,"")},a=function(e){var t;return t=e.trim(""+e),t=t.replace(/ +/g," ")},i=function(e){return a(e).split(" ")},o=function(e){var t,n;return n=i(e),t=n.map(function(e){return new RegExp(""+e,"i")}),[n,t]},t.exports=n},{}],5:[function(e,t){var n,a,i,o,r,s,l,c,u,d,p,h,f,g,m,v,_,y,w;r={},s={},f=function(e,t,n){var a;return a=n[e],n[e]?"web_site"===e?"<a target='_blank' href='"+a+"'>"+a+"</a>":""!==t?n[e+"_rank"]&&n.max_ranks&&n.max_ranks[e+"_max_rank"]?(a=numeral(a).format(t),a+" <span class='rank'>("+n[e+"_rank"]+" of "+n.max_ranks[e+"_max_rank"]+")</span>"):numeral(a).format("number_of_full_time_employees"===e?"0,0":t):(a.length>20&&"open_enrollment_schools"===e&&(a=a.substring(0,19)+("<div style='display:inline;color:#074d71'  title='"+a+"'>&hellip;</div>")),a.length>20&&"parent_trigger_eligible_schools"===e?a=a.substring(0,19)+("<div style='display:inline;color:#074d71'  title='"+a+"'>&hellip;</div>"):(a.length>21&&(a=a.substring(0,21)),a)):""},h=function(e){return s[e]},p=function(e){var t;return null!=r[e]?r[e]:(t=e.replace(/_/g," "),t=t.charAt(0).toUpperCase()+t.substring(1))},d=function(e,t){var n;return"_"===substr(e,0,1)?"<div>\n    <span class='f-nam' >"+p(e)+"</span>\n    <span class='f-val'>&nbsp;</span>\n</div>":(n=t[e])?"<div>\n    <span class='f-nam'  >"+p(e)+"<div></span>\n    <span class='f-val'>"+f(e,t)+"</span>\n</div>":""},v=function(e,t,n){var a;return a="",e=p(e),"heading"===t&&(0!==n&&(a+="<br/>"),a+="<div><span class='f-nam'>"+e+"</span><span class='f-val'> </span></div>"),a},g=function(e,t,n){var a,i,o,r,s,l,c,u;for(s="",l=c=0,u=e.length;u>c;l=++c)r=e[l],"object"==typeof r?"heading"===r.mask?(s+=v(r.name,r.mask,l),o=""):(o=f(r.name,r.mask,t),""!==o&&"0"!==o?(a=p(r.name),i=h(r.name)):o=""):(o=f(r,"",t),""!==o&&(a=p(r),i=h(a))),""!==o&&(s+=n({name:a,value:o,help:i}));return s},m=function(e,t){var n,a,i,r,s,l,c,u;for(i="",c="0,0",n="",r=!1,s=0,l=e.length;l>s;s++)a=e[s],n!==a.category_name&&(n=a.category_name,"Overview"===n?i+=t({name:"<b>"+n+"</b>",genfund:"",otherfunds:"",totalfunds:""}):"Revenues"===n?(i+="</br>",i+="<b>"+t({name:n,genfund:"General Fund",otherfunds:"Other Funds",totalfunds:"Total Gov. Funds"})+"</b>",r=!0):(i+="</br>",i+=t({name:"<b>"+n+"</b>",genfund:"",otherfunds:"",totalfunds:""}),r=!0)),"General Fund Balance"===a.caption||"Long Term Debt"===a.caption?i+=t({name:a.caption,genfund:o(a.genfund,c,'<span class="currency-sign">$</span>')}):"Total Revenues"===(u=a.caption)||"Total Expenditures"===u||"Surplus / (Deficit)"===u||r?(i+=t({name:a.caption,genfund:o(a.genfund,c,'<span class="currency-sign">$</span>'),otherfunds:o(a.otherfunds,c,'<span class="currency-sign">$</span>'),totalfunds:o(a.totalfunds,c,'<span class="currency-sign">$</span>')}),r=!1):i+=t({name:a.caption,genfund:o(a.genfund,c),otherfunds:o(a.otherfunds,c),totalfunds:o(a.totalfunds,c)});return i},w=function(e){return e.replace(/[\s\+\-]/g,"_")},y=function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},o=function(e,t,n){var a;return null==n&&(n=""),e=numeral(e),0>e?(a=e.format(t).toString(),a=a.replace(/-/g,""),"("+n+('<span class="fin-val">'+a+"</span>")+")"):(e=e.format(t),""+n+('<span class="fin-val">'+e+"</span>"))},_=function(e,t,n,a){var i,o,r,s,l,c,u,d,p,h,f,v,_,b,C,k,x,T,I,S,O;for(d=e,O=a.templates,x={},p={title:t.name,wikipedia_page_exists:t.wikipedia_page_exists,wikipedia_page_name:t.wikipedia_page_name,transparent_california_page_name:t.transparent_california_page_name,latest_audit_url:t.latest_audit_url,tabs:[],tabcontent:""},c=u=0,h=d.length;h>u;c=++u)S=d[c],p.tabs.push({tabid:w(S.name),tabname:S.name,active:c>0?"":"active"});for(c=_=0,f=d.length;f>_;c=++_){switch(S=d[c],o={tabid:w(S.name),tabname:S.name,active:c>0?"":"active",tabcontent:""},S.name){case"Overview + Elected Officials":for(o.tabcontent+=g(S.fields,t,O["tabdetail-namevalue-template"]),console.log(t),T=t.elected_officials,c=b=0,v=T.length;v>b;c=++b)C=T[c],k={title:""!==C.title?"Title: "+C.title:void 0,name:""!==C.full_name?"Name: "+C.full_name:void 0,email:C.email_address?"Email: "+C.email_address:void 0,telephonenumber:null!==C.telephone_number&&void 0!==C.telephone_number?"Telephone Number: "+C.telephone_number:void 0,termexpires:C.term_expires?"Term Expires: "+C.term_expires:"Term Expires: ",altTypeSlug:t.alt_type_slug,nameSlug:t.slug,slug:C.slug},k.image=""!==C.photo_url&&void 0!==C.photo_url?'<img src="'+C.photo_url+'" class="portrait" alt="" />':"",o.tabcontent+=O["tabdetail-official-template"](k);break;case"Employee Compensation":l="",l+=g(S.fields,t,O["tabdetail-namevalue-template"]),o.tabcontent+=O["tabdetail-employee-comp-template"]({content:l}),x["median-comp-graph"]||(s=!0,0===t.median_salary_per_full_time_emp&&(s=!1),0===t.median_benefits_per_ft_emp&&(s=!1),0===t.median_wages_general_public&&(s=!1),0===t.median_benefits_general_public&&(s=!1),I=340,i=470,$(window).width()<490&&(I=300,i=300),r=function(){return setTimeout(function(){var e,n,a,i;i=new google.visualization.DataTable,i.addColumn("string","Median Compensation"),i.addColumn("number","Wages"),i.addColumn("number","Bens."),i.addRows([[y(t.name+"\n Employees"),t.median_salary_per_full_time_emp,t.median_benefits_per_ft_emp],["All \n"+y(t.name+" \n Residents"),t.median_wages_general_public,t.median_benefits_general_public]]),n=new google.visualization.NumberFormat({groupingSymbol:",",fractionDigits:"0"}),n.format(i,1),n.format(i,2),a={title:"Median Total Compensation - Full Time Workers: \n Government vs. Private Sector",titleTextStyle:{fontSize:12},tooltip:{textStyle:{fontSize:12}},width:I,height:300,isStacked:"true",colors:["#005ce6","#009933"]},e=new google.visualization.ColumnChart(document.getElementById("median-comp-graph")),e.draw(i,a)},1e3)},s&&google.load("visualization","1.0",{packages:"corechart",callback:r()}),x["median-comp-graph"]="median-comp-graph"),x["median-pension-graph"]||(s=!0,0===t.median_pension_30_year_retiree&&(s=!1),r=function(){return setTimeout(function(){var e,n,a,i;i=new google.visualization.DataTable,i.addColumn("string","Median Pension"),i.addColumn("number","Wages"),i.addRows([["Pension for \n Retiree w/ 30 Years",t.median_pension30_year_retiree]]),n=new google.visualization.NumberFormat({groupingSymbol:",",fractionDigits:"0"}),n.format(i,1),a={title:"Median Total Pension",titleTextStyle:{fontSize:12},tooltip:{textStyle:{fontSize:12}},width:I,height:300,bar:{groupWidth:"30%"},isStacked:"true",colors:["#005ce6","#009933"]},s&&(e=new google.visualization.ColumnChart(document.getElementById("median-pension-graph")),e.draw(i,a))},1e3)},google.load("visualization","1.0",{packages:"corechart",callback:r()}),x["median-pension-graph"]="median-pension-graph");break;case"Financial Health":l="",l+=g(S.fields,t,O["tabdetail-namevalue-template"]),o.tabcontent+=O["tabdetail-financial-health-template"]({content:l}),x["public-safety-pie"]||"School District"===t.alt_type||(s=!0,0===t.public_safety_exp_over_tot_gov_fund_revenue&&(s=!1),r=function(){return setTimeout(function(){var e,n,a;a=new google.visualization.DataTable,a.addColumn("string","Public Safety Expense"),a.addColumn("number","Total"),a.addRows([["Public Safety Exp",1-t.public_safety_exp_over_tot_gov_fund_revenue],["Other",t.public_safety_exp_over_tot_gov_fund_revenue]]),n={title:"Public safety expense",titleTextStyle:{fontSize:12},tooltip:{textStyle:{fontSize:12
}},width:I,height:300,is3D:"true",colors:["#005ce6","#009933"],slices:{1:{offset:.2}},pieStartAngle:45},e=new google.visualization.PieChart(document.getElementById("public-safety-pie")),e.draw(a,n)},1e3)},s&&google.load("visualization","1.0",{packages:"corechart",callback:r()}),x["public-safety-pie"]="public-safety-pie"),x["fin-health-revenue-graph"]||"School District"===t.alt_type||(s=!0,0===t.total_revenue_per_capita&&(s=!1),r=function(){return setTimeout(function(){var e,n,a;a=new google.visualization.DataTable,a.addColumn("string","Per Capita"),a.addColumn("number","Rev."),a.addRows([["Total Revenue \n Per Capita",t.total_revenue_per_capita],["Median Total \n Revenue Per \n Capita For All Cities",420]]),n={title:"Total Revenue",titleTextStyle:{fontSize:12},tooltip:{textStyle:{fontSize:12}},width:I,height:300,isStacked:"true",colors:["#005ce6","#009933"],"chartArea.width":"100%"},e=new google.visualization.ColumnChart(document.getElementById("fin-health-revenue-graph")),e.draw(a,n)},1e3)},s&&google.load("visualization","1.0",{packages:"corechart",callback:r()}),x["fin-health-revenue-graph"]="fin-health-revenue-graph"),x["fin-health-expenditures-graph"]||"School District"===t.alt_type||(s=!0,0===t.total_expenditures_per_capita&&(s=!1),r=function(){return setTimeout(function(){var e,n,a;a=new google.visualization.DataTable,a.addColumn("string","Per Capita"),a.addColumn("number","Exp."),a.addRows([["Total Expenditures \n Per Capita",t.total_expenditures_per_capita],["Median Total \n Expenditures \n Per Capita \n For All Cities",420]]),n={title:"Total Expenditures",titleTextStyle:{fontSize:12},tooltip:{textStyle:{fontSize:12}},width:I,height:300,isStacked:"true",colors:["#005ce6","#009933"],"chartArea.width":"100%"},s&&(e=new google.visualization.ColumnChart(document.getElementById("fin-health-expenditures-graph")),e.draw(a,n))},1e3)},google.load("visualization","1.0",{packages:"corechart",callback:r()}),x["fin-health-expenditures-graph"]="fin-health-expenditures-graph");break;case"Financial Statements":t.financial_statements&&(l="",l+=m(t.financial_statements,O["tabdetail-finstatement-template"]),o.tabcontent+=O["tabdetail-financial-statements-template"]({content:l}),x["total-revenue-pie"]||(s=!0,0===t.financial_statements.length&&(s=!1),r=function(){return setTimeout(function(){var e,n,a,o,r,l,c,u,d;for(d=new google.visualization.DataTable,d.addColumn("string","Total Gov. Expenditures"),d.addColumn("number","Total"),u=[],c=t.financial_statements,r=0,a=c.length;a>r;r++)n=c[r],"Revenues"===n.category_name&&"Total Revenues"!==n.caption&&(l=[n.caption,parseInt(n.totalfunds)],u.push(l));d.addRows(u),o={title:"Total Revenues",titleTextStyle:{fontSize:16},tooltip:{textStyle:{fontSize:12}},width:i,height:350,pieStartAngle:60,sliceVisibilityThreshold:.05,forceIFrame:!0,chartArea:{width:"90%",height:"75%"}},s&&(e=new google.visualization.PieChart(document.getElementById("total-revenue-pie")),e.draw(d,o))},1e3)}),s&&google.load("visualization","1.0",{packages:"corechart",callback:r()}),x["total-revenue-pie"]="total-revenue-pie",x["total-expenditures-pie"]||(s=!0,0===t.financial_statements.length&&(s=!1),r=function(){return setTimeout(function(){var e,n,a,o,r,l,c,u,d;for(d=new google.visualization.DataTable,d.addColumn("string","Total Gov. Expenditures"),d.addColumn("number","Total"),u=[],c=t.financial_statements,r=0,a=c.length;a>r;r++)n=c[r],"Expenditures"===n.category_name&&"Total Expenditures"!==n.caption&&(l=[n.caption,parseInt(n.totalfunds)],u.push(l));d.addRows(u),o={title:"Total Expenditures",titleTextStyle:{fontSize:16},tooltip:{textStyle:{fontSize:12}},width:i,height:350,pieStartAngle:60,sliceVisibilityThreshold:.05,forceIFrame:!0,chartArea:{width:"90%",height:"75%"}},s&&(e=new google.visualization.PieChart(document.getElementById("total-expenditures-pie")),e.draw(d,o))},1e3)}),s&&google.load("visualization","1.0",{packages:"corechart",callback:r()}),x["total-expenditures-pie"]="total-expenditures-pie");break;default:o.tabcontent+=g(S.fields,t,O["tabdetail-namevalue-template"])}p.tabcontent+=O["tabdetail-template"](o)}return O["tabpanel-template"](p)},l=function(e){var t,n,a,i,o,r,s,l;for(t={},a=0,i=e.length;i>a;a++)for(l=e[a],s=l.fields,r=0,o=s.length;o>r;r++)n=s[r],t[n]=1;return t},c=function(e){var t,n;t={};for(n in e)t[n]=1;return t},u=function(e,t){var n,a,i,o;a=l(e),i=c(t),o=[];for(n in i)a[n]||o.push(n);return o},a=function(e,t){var n,a;return null==e&&(e=[]),n=$.extend(!0,[],e),a={name:"Other",fields:u(n,t)},n.push(a),n},i=function(e){var t,n,a,i,o,l,c,u,d,p,h,f,g,m,v,_,y,w,b,$,C,k,x,T,I,S,O,j;for(I={},O=[],u=function(){var t,n,a,i,o,r;for(t={},r=e.columns,a=i=0,o=r.length;o>i;a=++i)n=r[a],t[n]=a;return t},j=function(e,t,n){return t[n[e]]},d=function(e){var t,n,a;t=[];for(n in e)a={},a.name=n,a.fields=e[n],t.push(a);return t},o=u(e.col_hash),C=0,k=e.rows,p=h=0,f=k.length;f>h;p=++h)T=k[p],i=j("general_category",T,o),l=j("field_name",T,o),l||(l="_"+String(++C)),r[j("field_name",T,o)]=j("description",T,o),s[l]=j("help_text",T,o),i&&(null==I[i]&&(I[i]=[]),I[i].push({n:j("n",T,o),name:l,mask:j("mask",T,o)}));for(t=Object.keys(I),a={},_=0,g=t.length;g>_;_++){for(i=t[_],a[i]||(a[i]=I[i][0].n),c=[],x=I[i],w=0,m=x.length;m>w;w++)b=x[w],c.push(b);c.sort(function(e,t){return e.n-t.n}),I[i]=c}n=[];for(i in a)y=a[i],n.push({category:i,n:y});for(n.sort(function(e,t){return e.n-t.n}),S={},$=0,v=n.length;v>$;$++)i=n[$],S[i.category]=I[i.category];return O=d(S)},n=function(){function e(){var e,t,n,a,i,o,r,s;for(this.list=[],this.events={},r=["tabpanel-template","tabdetail-template","tabdetail-namevalue-template","tabdetail-finstatement-template","tabdetail-official-template","tabdetail-employee-comp-template","tabdetail-financial-health-template","tabdetail-financial-statements-template","person-info-template"],s=["tab-template"],this.templates={},e=t=0,n=r.length;n>t;e=++t)o=r[e],this.templates[o]=Handlebars.compile($("#"+o).html());for(e=i=0,a=s.length;a>i;e=++i)o=s[e],Handlebars.registerPartial(o,$("#"+o).html())}return e.list=void 0,e.templates=void 0,e.data=void 0,e.events=void 0,e.prototype.add_template=function(e,t){return this.list.push({parent:this,name:e,render:function(e){return this.parent.data=e,_(t,e,this,this.parent)},bind:function(e,t){return this.parent.events[e]?this.parent.events[e].push(t):this.parent.events[e]=[t]},activate:function(e){var t,n,a,i,o,r;if(this.parent.events[e]){for(o=this.parent.events[e],r=[],n=a=0,i=o.length;i>a;n=++a)t=o[n],r.push(t(e,this.parent.data));return r}}})},e.prototype.load_template=function(e,t){return $.ajax({url:t,dataType:"json",cache:!0,async:!1,success:function(t){return function(n){return t.add_template(e,n)}}(this)})},e.prototype.load_fusion_template=function(e,t){return $.ajax({url:t,dataType:"json",cache:!0,async:!1,success:function(t){return function(n){var a;return a=i(n),t.add_template(e,a)}}(this)})},e.prototype.get_names=function(){var e,t,n,a,i;for(n=this.list,a=[],e=0,t=n.length;t>e;e++)i=n[e],a.push(i.name);return a},e.prototype.get_index_by_name=function(e){var t,n,a,i,o;for(i=this.list,t=n=0,a=i.length;a>n;t=++n)o=i[t],o.name===e;return-1},e.prototype.get_html=function(e,t){return-1===e?"":this.list[e]?this.list[e].render(t):""},e.prototype.activate=function(e,t){return this.list[e]?this.list[e].activate(t):void 0},e}(),t.exports=n},{}],6:[function(e,t){var n,a;$(function(){return window.get_wikipedia_article=a,window.create_wikipedia_article=n}),a=function(e){var t;return t=e.replace(/.*\/([^\/]*)$/,"$1"),$.getJSON("http://en.wikipedia.org/w/api.php?action=parse&page="+t+"&prop=text&format=json&callback=?",function(e){return $("#wikipediaTitle").html(e.parse.title),$("#wikipediaArticle").html(e.parse.text["*"]),$("#wikipediaArticle").find("a:not(.references a)").attr("href",function(){return"http://www.wikipedia.org"+$(this).attr("href")}),$("#wikipediaArticle").find("a").attr("target","_blank")})},n=function(){return alert("Not implemented")},t.exports={get_wikipedia_article:a}},{}]},{},[3]);