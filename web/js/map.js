webpackJsonp([3],[function(t,e,n){(function(t){var e=n(48);n(40),n(53),t("#year-selector").change(function(){t("#map").hide(),gw.map.year=t(this).find("option:selected").val(),e.removeAllSubLayers(),e.reInit()})}).call(e,n(1))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var i,r,i,r;(function(o){/*!
	 * typeahead.js 0.11.1
	 * https://github.com/twitter/typeahead.js
	 * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT
	 */
!function(o,s){i=[n(1)],r=function(t){return o.Bloodhound=s(t)}.apply(e,i),!(void 0!==r&&(t.exports=r))}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?void 0:!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?!1:void 0}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var o,s,a=this,u=arguments;return o=function(){i=null,n||(r=t.apply(a,u))},s=n&&!i,clearTimeout(i),i=setTimeout(o,e),s&&(r=t.apply(a,u)),r}},throttle:function(t,e){var n,i,r,o,s,a;return s=0,a=function(){s=new Date,r=null,o=t.apply(n,i)},function(){var u=new Date,c=e-(u-s);return n=this,i=arguments,0>=c?(clearTimeout(r),r=null,s=u,o=t.apply(n,i)):r||(r=setTimeout(a,c)),o}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n="0.11.1",i=function(){"use strict";function t(t){return t=e.toStr(t),t?t.split(/\s+/):[]}function n(t){return t=e.toStr(t),t?t.split(/\W+/):[]}function i(t){return function(n){return n=e.isArray(n)?n:[].slice.call(arguments,0),function(i){var r=[];return e.each(n,function(n){r=r.concat(t(e.toStr(i[n])))}),r}}}return{nonword:n,whitespace:t,obj:{nonword:i(n),whitespace:i(t)}}}(),r=function(){"use strict";function n(n){this.maxSize=e.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function i(){this.head=this.tail=null}function r(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(n.prototype,{set:function(t,e){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key],this.size--),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new r(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];return e?(this.list.moveToFront(e),e.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new i}}),e.mixin(i.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),n}(),o=function(){"use strict";function n(t,n){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix)),this.ls=n||a,!this.ls&&this._noop()}function i(){return(new Date).getTime()}function r(t){return JSON.stringify(e.isUndefined(t)?null:t)}function o(e){return t.parseJSON(e)}function s(t){var e,n,i=[],r=a.length;for(e=0;r>e;e++)(n=a.key(e)).match(t)&&i.push(n.replace(t,""));return i}var a;try{a=window.localStorage,a.setItem("~~~","!"),a.removeItem("~~~")}catch(u){a=null}return e.mixin(n.prototype,{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=e.noop},_safeSet:function(t,e){try{this.ls.setItem(t,e)}catch(n){"QuotaExceededError"===n.name&&(this.clear(),this._noop())}},get:function(t){return this.isExpired(t)&&this.remove(t),o(this.ls.getItem(this._prefix(t)))},set:function(t,n,o){return e.isNumber(o)?this._safeSet(this._ttlKey(t),r(i()+o)):this.ls.removeItem(this._ttlKey(t)),this._safeSet(this._prefix(t),r(n))},remove:function(t){return this.ls.removeItem(this._ttlKey(t)),this.ls.removeItem(this._prefix(t)),this},clear:function(){var t,e=s(this.keyMatcher);for(t=e.length;t--;)this.remove(e[t]);return this},isExpired:function(t){var n=o(this.ls.getItem(this._ttlKey(t)));return!!(e.isNumber(n)&&i()>n)}}),n}(),s=function(){"use strict";function n(t){t=t||{},this.cancelled=!1,this.lastReq=null,this._send=t.transport,this._get=t.limiter?t.limiter(this._get):this._get,this._cache=t.cache===!1?new r(0):a}var i=0,o={},s=6,a=new r(10);return n.setMaxPendingRequests=function(t){s=t},n.resetCache=function(){a.reset()},e.mixin(n.prototype,{_fingerprint:function(e){return e=e||{},e.url+e.type+t.param(e.data||{})},_get:function(t,e){function n(t){e(null,t),l._cache.set(u,t)}function r(){e(!0)}function a(){i--,delete o[u],l.onDeckRequestArgs&&(l._get.apply(l,l.onDeckRequestArgs),l.onDeckRequestArgs=null)}var u,c,l=this;u=this._fingerprint(t),this.cancelled||u!==this.lastReq||((c=o[u])?c.done(n).fail(r):s>i?(i++,o[u]=this._send(t).done(n).fail(r).always(a)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(n,i){var r,o;i=i||t.noop,n=e.isString(n)?{url:n}:n||{},o=this._fingerprint(n),this.cancelled=!1,this.lastReq=o,(r=this._cache.get(o))?i(null,r):this._get(n,i)},cancel:function(){this.cancelled=!0}}),n}(),a=window.SearchIndex=function(){"use strict";function n(n){n=n||{},n.datumTokenizer&&n.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.identify=n.identify||e.stringify,this.datumTokenizer=n.datumTokenizer,this.queryTokenizer=n.queryTokenizer,this.reset()}function i(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function r(){var t={};return t[u]=[],t[a]={},t}function o(t){for(var e={},n=[],i=0,r=t.length;r>i;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}function s(t,e){var n=0,i=0,r=[];t=t.sort(),e=e.sort();for(var o=t.length,s=e.length;o>n&&s>i;)t[n]<e[i]?n++:t[n]>e[i]?i++:(r.push(t[n]),n++,i++);return r}var a="c",u="i";return e.mixin(n.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var n=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var o,s;n.datums[o=n.identify(t)]=t,s=i(n.datumTokenizer(t)),e.each(s,function(t){var e,i,s;for(e=n.trie,i=t.split("");s=i.shift();)e=e[a][s]||(e[a][s]=r()),e[u].push(o)})})},get:function(t){var n=this;return e.map(t,function(t){return n.datums[t]})},search:function(t){var n,r,c=this;return n=i(this.queryTokenizer(t)),e.each(n,function(t){var e,n,i,o;if(r&&0===r.length)return!1;for(e=c.trie,n=t.split("");e&&(i=n.shift());)e=e[a][i];return e&&0===n.length?(o=e[u].slice(0),void(r=r?s(r,o):o)):(r=[],!1)}),r?e.map(o(r),function(t){return c.datums[t]}):[]},all:function(){var t=[];for(var e in this.datums)t.push(this.datums[e]);return t},reset:function(){this.datums={},this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),u=function(){"use strict";function t(t){this.url=t.url,this.ttl=t.ttl,this.cache=t.cache,this.prepare=t.prepare,this.transform=t.transform,this.transport=t.transport,this.thumbprint=t.thumbprint,this.storage=new o(t.cacheKey)}var n;return n={data:"data",protocol:"protocol",thumbprint:"thumbprint"},e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(t){this.cache&&(this.storage.set(n.data,t,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var t,e={};return this.cache?(e.data=this.storage.get(n.data),e.protocol=this.storage.get(n.protocol),e.thumbprint=this.storage.get(n.thumbprint),t=e.thumbprint!==this.thumbprint||e.protocol!==location.protocol,e.data&&!t?e.data:null):null},fromNetwork:function(t){function e(){t(!0)}function n(e){t(null,r.transform(e))}var i,r=this;t&&(i=this.prepare(this._settings()),this.transport(i).fail(e).done(n))},clear:function(){return this.storage.clear(),this}}),t}(),c=function(){"use strict";function t(t){this.url=t.url,this.prepare=t.prepare,this.transform=t.transform,this.transport=new s({cache:t.cache,limiter:t.limiter,transport:t.transport})}return e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(t,e){function n(t,n){e(t?[]:r.transform(n))}var i,r=this;if(e)return t=t||"",i=this.prepare(t,this._settings()),this.transport.get(i,n)},cancelLastRequest:function(){this.transport.cancel()}}),t}(),l=function(){"use strict";function i(i){var r;return i?(r={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:e.identity,transform:e.identity,transport:null},i=e.isString(i)?{url:i}:i,i=e.mixin(r,i),!i.url&&t.error("prefetch requires url to be set"),i.transform=i.filter||i.transform,i.cacheKey=i.cacheKey||i.url,i.thumbprint=n+i.thumbprint,i.transport=i.transport?a(i.transport):t.ajax,i):null}function r(n){var i;if(n)return i={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:e.identity,transport:null},n=e.isString(n)?{url:n}:n,n=e.mixin(i,n),!n.url&&t.error("remote requires url to be set"),n.transform=n.filter||n.transform,n.prepare=o(n),n.limiter=s(n),n.transport=n.transport?a(n.transport):t.ajax,delete n.replace,delete n.wildcard,delete n.rateLimitBy,delete n.rateLimitWait,n}function o(t){function e(t,e){return e.url=o(e.url,t),e}function n(t,e){return e.url=e.url.replace(s,encodeURIComponent(t)),e}function i(t,e){return e}var r,o,s;return r=t.prepare,o=t.replace,s=t.wildcard,r?r:r=o?e:t.wildcard?n:i}function s(t){function n(t){return function(n){return e.debounce(n,t)}}function i(t){return function(n){return e.throttle(n,t)}}var r,o,s;return r=t.limiter,o=t.rateLimitBy,s=t.rateLimitWait,r||(r=/^throttle$/i.test(o)?i(s):n(s)),r}function a(n){return function(i){function r(t){e.defer(function(){s.resolve(t)})}function o(t){e.defer(function(){s.reject(t)})}var s=t.Deferred();return n(i,r,o),s}}return function(n){var o,s;return o={initialize:!0,identify:e.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},n=e.mixin(o,n||{}),!n.datumTokenizer&&t.error("datumTokenizer is required"),!n.queryTokenizer&&t.error("queryTokenizer is required"),s=n.sorter,n.sorter=s?function(t){return t.sort(s)}:e.identity,n.local=e.isFunction(n.local)?n.local():n.local,n.prefetch=i(n.prefetch),n.remote=r(n.remote),n}}(),h=function(){"use strict";function n(t){t=l(t),this.sorter=t.sorter,this.identify=t.identify,this.sufficient=t.sufficient,this.local=t.local,this.remote=t.remote?new c(t.remote):null,this.prefetch=t.prefetch?new u(t.prefetch):null,this.index=new a({identify:this.identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),t.initialize!==!1&&this.initialize()}var r;return r=window&&window.Bloodhound,n.noConflict=function(){return window&&(window.Bloodhound=r),n},n.tokenizers=i,e.mixin(n.prototype,{__ttAdapter:function(){function t(t,e,i){return n.search(t,e,i)}function e(t,e){return n.search(t,e)}var n=this;return this.remote?t:e},_loadPrefetch:function(){function e(t,e){return t?n.reject():(r.add(e),r.prefetch.store(r.index.serialize()),void n.resolve())}var n,i,r=this;return n=t.Deferred(),this.prefetch?(i=this.prefetch.fromCache())?(this.index.bootstrap(i),n.resolve()):this.prefetch.fromNetwork(e):n.resolve(),n.promise()},_initialize:function(){function t(){e.add(e.local)}var e=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(t),this.initPromise},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){return this.index.add(t),this},get:function(t){return t=e.isArray(t)?t:[].slice.call(arguments),this.index.get(t)},search:function(t,n,i){function r(t){var n=[];e.each(t,function(t){!e.some(o,function(e){return s.identify(t)===s.identify(e)})&&n.push(t)}),i&&i(n)}var o,s=this;return o=this.sorter(this.index.search(t)),n(this.remote?o.slice():o),this.remote&&o.length<this.sufficient?this.remote.get(t,r):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return s.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),n}();return h}),function(o,s){i=[n(1)],r=function(t){return s(t)}.apply(e,i),!(void 0!==r&&(t.exports=r))}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?void 0:!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?!1:void 0}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var o,s,a=this,u=arguments;return o=function(){i=null,n||(r=t.apply(a,u))},s=n&&!i,clearTimeout(i),i=setTimeout(o,e),s&&(r=t.apply(a,u)),r}},throttle:function(t,e){var n,i,r,o,s,a;return s=0,a=function(){s=new Date,r=null,o=t.apply(n,i)},function(){var u=new Date,c=e-(u-s);return n=this,i=arguments,0>=c?(clearTimeout(r),r=null,s=u,o=t.apply(n,i)):r||(r=setTimeout(a,c)),o}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n=function(){"use strict";function t(t){var s,a;return a=e.mixin({},o,t),s={css:r(),classes:a,html:n(a),selectors:i(a)},{css:s.css,html:s.html,classes:s.classes,selectors:s.selectors,mixin:function(t){e.mixin(t,s)}}}function n(t){return{wrapper:'<span class="'+t.wrapper+'"></span>',menu:'<div class="'+t.menu+'"></div>'}}function i(t){var n={};return e.each(t,function(t,e){n[e]="."+t}),n}function r(){var t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return e.isMsie()&&e.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),t}var o={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return t}(),i=function(){"use strict";function n(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}var i,r;return i="typeahead:",r={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},e.mixin(n.prototype,{_trigger:function(e,n){var r;return r=t.Event(i+e),(n=n||[]).unshift(r),this.$el.trigger.apply(this.$el,n),r},before:function(t){var e,n;return e=[].slice.call(arguments,1),n=this._trigger("before"+t,e),n.isDefaultPrevented()},trigger:function(t){var e;this._trigger(t,[].slice.call(arguments,1)),(e=r[t])&&this._trigger(e,[].slice.call(arguments,1))}}),n}(),r=function(){"use strict";function t(t,e,n,i){var r;if(!n)return this;for(e=e.split(c),n=i?u(n,i):n,this._callbacks=this._callbacks||{};r=e.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][t].push(n);return this}function e(e,n,i){return t.call(this,"async",e,n,i)}function n(e,n,i){return t.call(this,"sync",e,n,i)}function i(t){var e;if(!this._callbacks)return this;for(t=t.split(c);e=t.shift();)delete this._callbacks[e];return this}function r(t){var e,n,i,r,o;if(!this._callbacks)return this;for(t=t.split(c),i=[].slice.call(arguments,1);(e=t.shift())&&(n=this._callbacks[e]);)r=s(n.sync,this,[e].concat(i)),o=s(n.async,this,[e].concat(i)),r()&&l(o);return this}function s(t,e,n){function i(){for(var i,r=0,o=t.length;!i&&o>r;r+=1)i=t[r].apply(e,n)===!1;return!i}return i}function a(){var t;return t=window.setImmediate?function(t){o(function(){t()})}:function(t){setTimeout(function(){t()},0)}}function u(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}var c=/\s+/,l=a();return{onSync:n,onAsync:e,off:i,trigger:r}}(),s=function(t){"use strict";function n(t,n,i){for(var r,o=[],s=0,a=t.length;a>s;s++)o.push(e.escapeRegExChars(t[s]));return r=i?"\\b("+o.join("|")+")\\b":"("+o.join("|")+")",n?new RegExp(r):new RegExp(r,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(r){function o(e){var n,i,o;return(n=a.exec(e.data))&&(o=t.createElement(r.tagName),r.className&&(o.className=r.className),i=e.splitText(n.index),i.splitText(n[0].length),o.appendChild(i.cloneNode(!0)),e.parentNode.replaceChild(o,i)),!!n}function s(t,e){for(var n,i=3,r=0;r<t.childNodes.length;r++)n=t.childNodes[r],n.nodeType===i?r+=e(n)?1:0:s(n,e)}var a;r=e.mixin({},i,r),r.node&&r.pattern&&(r.pattern=e.isArray(r.pattern)?r.pattern:[r.pattern],a=n(r.pattern,r.caseSensitive,r.wordsOnly),s(r.node,o))}}(window.document),a=function(){"use strict";function n(n,r){n=n||{},n.input||t.error("input is missing"),r.mixin(this),this.$hint=t(n.hint),this.$input=t(n.input),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=i(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop)}function i(e){return t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function o(t,e){return n.normalizeQuery(t)===n.normalizeQuery(e)}function s(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var a;return a={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(t){return e.toStr(t).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},e.mixin(n.prototype,r,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(t){var e=a[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(t,e){var n;switch(t){case"up":case"down":n=!s(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!s(e);break;default:n=!0}return n},_checkLanguageDirection:function(){var t=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==t&&(this.dir=t,this.$hint.attr("dir",t),this.trigger("langDirChanged",t))},_setQuery:function(t,e){var n,i;n=o(t,this.query),i=n?this.query.length!==t.length:!1,this.query=t,e||n?!e&&i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var t,n,i,r,o=this;return t=e.bind(this._onBlur,this),n=e.bind(this._onFocus,this),i=e.bind(this._onKeydown,this),r=e.bind(this._onInput,this),this.$input.on("blur.tt",t).on("focus.tt",n).on("keydown.tt",i),!e.isMsie()||e.isMsie()>9?this.$input.on("input.tt",r):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){a[t.which||t.keyCode]||e.defer(e.bind(o._onInput,o,t))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(t,e){this.setInputValue(t),this._setQuery(t,e)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(t){this.$input.val(t),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n,i;t=this.getInputValue(),e=this.getHint(),n=t!==e&&0===e.indexOf(t),i=""!==t&&n&&!this.hasOverflow(),!i&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,n,i;return t=this.$input.val().length,n=this.$input[0].selectionStart,e.isNumber(n)?n===t:document.selection?(i=document.selection.createRange(),i.moveStart("character",-t),t===i.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=t("<div>")}}),n}(),u=function(){"use strict";function n(n,r){n=n||{},n.templates=n.templates||{},n.templates.notFound=n.templates.notFound||n.templates.empty,n.source||t.error("missing source"),n.node||t.error("missing node"),n.name&&!a(n.name)&&t.error("invalid dataset name: "+n.name),r.mixin(this),this.highlight=!!n.highlight,this.name=n.name||c(),this.limit=n.limit||5,this.displayFn=i(n.display||n.displayKey),this.templates=o(n.templates,this.displayFn),this.source=n.source.__ttAdapter?n.source.__ttAdapter():n.source,this.async=e.isUndefined(n.async)?this.source.length>2:!!n.async,this._resetLastSuggestion(),this.$el=t(n.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function i(t){function n(e){return e[t]}return t=t||e.stringify,e.isFunction(t)?t:n}function o(n,i){function r(e){return t("<div>").text(i(e))}return{notFound:n.notFound&&e.templatify(n.notFound),pending:n.pending&&e.templatify(n.pending),header:n.header&&e.templatify(n.header),footer:n.footer&&e.templatify(n.footer),suggestion:n.suggestion||r}}function a(t){return/^[_a-zA-Z0-9-]+$/.test(t)}var u,c;return u={val:"tt-selectable-display",obj:"tt-selectable-object"},c=e.getIdGenerator(),n.extractData=function(e){var n=t(e);return n.data(u.obj)?{val:n.data(u.val)||"",obj:n.data(u.obj)||null}:null},e.mixin(n.prototype,r,{_overwrite:function(t,e){e=e||[],e.length?this._renderSuggestions(t,e):this.async&&this.templates.pending?this._renderPending(t):!this.async&&this.templates.notFound?this._renderNotFound(t):this._empty(),this.trigger("rendered",this.name,e,!1)},_append:function(t,e){e=e||[],e.length&&this.$lastSuggestion.length?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(t),this.trigger("rendered",this.name,e,!0)},_renderSuggestions:function(t,e){var n;n=this._getSuggestionsFragment(t,e),this.$lastSuggestion=n.children().last(),this.$el.html(n).prepend(this._getHeader(t,e)).append(this._getFooter(t,e))},_appendSuggestions:function(t,e){var n,i;n=this._getSuggestionsFragment(t,e),i=n.children().last(),this.$lastSuggestion.after(n),this.$lastSuggestion=i},_renderPending:function(t){var e=this.templates.pending;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_renderNotFound:function(t){var e=this.templates.notFound;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(n,i){var r,o=this;return r=document.createDocumentFragment(),e.each(i,function(e){var i,s;s=o._injectQuery(n,e),i=t(o.templates.suggestion(s)).data(u.obj,e).data(u.val,o.displayFn(e)).addClass(o.classes.suggestion+" "+o.classes.selectable),r.appendChild(i[0])}),this.highlight&&s({className:this.classes.highlight,node:r,pattern:n}),t(r)},_getFooter:function(t,e){return this.templates.footer?this.templates.footer({query:t,suggestions:e,dataset:this.name}):null},_getHeader:function(t,e){return this.templates.header?this.templates.header({query:t,suggestions:e,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=t()},_injectQuery:function(t,n){return e.isObject(n)?e.mixin({_query:t},n):n},update:function(e){function n(t){s||(s=!0,t=(t||[]).slice(0,r.limit),a=t.length,r._overwrite(e,t),a<r.limit&&r.async&&r.trigger("asyncRequested",e))}function i(n){n=n||[],!o&&a<r.limit&&(r.cancel=t.noop,a+=n.length,r._append(e,n),r.async&&r.trigger("asyncReceived",e))}var r=this,o=!1,s=!1,a=0;this.cancel(),this.cancel=function(){o=!0,r.cancel=t.noop,r.async&&r.trigger("asyncCanceled",e)},this.source(e,n,i),!s&&n([])},cancel:t.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=t("<div>")}}),n}(),c=function(){"use strict";function n(n,i){function r(e){var n=o.$node.find(e.node).first();return e.node=n.length?n:t("<div>").appendTo(o.$node),new u(e,i)}var o=this;n=n||{},n.node||t.error("node is required"),i.mixin(this),this.$node=t(n.node),this.query=null,this.datasets=e.map(n.datasets,r)}return e.mixin(n.prototype,r,{_onSelectableClick:function(e){this.trigger("selectableClicked",t(e.currentTarget))},_onRendered:function(t,e,n,i){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",e,n,i)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){function t(t){return t.isEmpty()}return e.every(this.datasets,t)},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var t=this.getActiveSelectable();t&&t.removeClass(this.classes.cursor)},_ensureVisible:function(t){var e,n,i,r;e=t.position().top,n=e+t.outerHeight(!0),i=this.$node.scrollTop(),r=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),0>e?this.$node.scrollTop(i+e):n>r&&this.$node.scrollTop(i+(n-r))},bind:function(){var t,n=this;return t=e.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,t),e.each(this.datasets,function(t){t.onSync("asyncRequested",n._propagate,n).onSync("asyncCanceled",n._propagate,n).onSync("asyncReceived",n._propagate,n).onSync("rendered",n._onRendered,n).onSync("cleared",n._onCleared,n)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(t){this.$node.attr("dir",t)},selectableRelativeToCursor:function(t){var e,n,i,r;return n=this.getActiveSelectable(),e=this._getSelectables(),i=n?e.index(n):-1,r=i+t,r=(r+1)%(e.length+1)-1,r=-1>r?e.length-1:r,-1===r?null:e.eq(r)},setCursor:function(t){this._removeCursor(),(t=t&&t.first())&&(t.addClass(this.classes.cursor),this._ensureVisible(t))},getSelectableData:function(t){return t&&t.length?u.extractData(t):null},getActiveSelectable:function(){var t=this._getSelectables().filter(this.selectors.cursor).first();return t.length?t:null},getTopSelectable:function(){var t=this._getSelectables().first();return t.length?t:null},update:function(t){function n(e){e.update(t)}var i=t!==this.query;return i&&(this.query=t,e.each(this.datasets,n)),i},empty:function(){function t(t){t.clear()}e.each(this.datasets,t),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){function n(t){t.destroy()}this.$node.off(".tt"),this.$node=t("<div>"),e.each(this.datasets,n)}}),n}(),l=function(){"use strict";function t(){c.apply(this,[].slice.call(arguments,0))}var n=c.prototype;return e.mixin(t.prototype,c.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),n.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),n.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(t){return this.$node.css("ltr"===t?this.css.ltr:this.css.rtl),n.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),t}(),h=function(){"use strict";function n(n,r){var o,s,a,u,c,l,h,d,f,p,g;n=n||{},n.input||t.error("missing input"),n.menu||t.error("missing menu"),n.eventBus||t.error("missing event bus"),r.mixin(this),this.eventBus=n.eventBus,this.minLength=e.isNumber(n.minLength)?n.minLength:1,this.input=n.input,this.menu=n.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),o=i(this,"activate","open","_onFocused"),s=i(this,"deactivate","_onBlurred"),a=i(this,"isActive","isOpen","_onEnterKeyed"),u=i(this,"isActive","isOpen","_onTabKeyed"),c=i(this,"isActive","_onEscKeyed"),l=i(this,"isActive","open","_onUpKeyed"),h=i(this,"isActive","open","_onDownKeyed"),d=i(this,"isActive","isOpen","_onLeftKeyed"),f=i(this,"isActive","isOpen","_onRightKeyed"),p=i(this,"_openIfActive","_onQueryChanged"),g=i(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",o,this).onSync("blurred",s,this).onSync("enterKeyed",a,this).onSync("tabKeyed",u,this).onSync("escKeyed",c,this).onSync("upKeyed",l,this).onSync("downKeyed",h,this).onSync("leftKeyed",d,this).onSync("rightKeyed",f,this).onSync("queryChanged",p,this).onSync("whitespaceChanged",g,this).onSync("langDirChanged",this._onLangDirChanged,this)}function i(t){var n=[].slice.call(arguments,1);return function(){var i=[].slice.call(arguments);e.each(n,function(e){return t[e].apply(t,i)})}}return e.mixin(n.prototype,{_hacks:function(){var n,i;n=this.input.$input||t("<div>"),i=this.menu.$node||t("<div>"),n.on("blur.tt",function(t){var r,o,s;r=document.activeElement,o=i.is(r),s=i.has(r).length>0,e.isMsie()&&(o||s)&&(t.preventDefault(),t.stopImmediatePropagation(),e.defer(function(){
n.focus()}))}),i.on("mousedown.tt",function(t){t.preventDefault()})},_onSelectableClicked:function(t,e){this.select(e)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(t,e,n,i){this._updateHint(),this.eventBus.trigger("render",n,i,e)},_onAsyncRequested:function(t,e,n){this.eventBus.trigger("asyncrequest",n,e)},_onAsyncCanceled:function(t,e,n){this.eventBus.trigger("asynccancel",n,e)},_onAsyncReceived:function(t,e,n){this.eventBus.trigger("asyncreceive",n,e)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())&&this.select(n)&&e.preventDefault()},_onTabKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&e.preventDefault():(n=this.menu.getTopSelectable())&&this.autocomplete(n)&&e.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(t,e){this._minLengthMet(e)?this.menu.update(e):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(t,e){this.dir!==e&&(this.dir=e,this.menu.setLanguageDirection(e))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(t){return t=e.isString(t)?t:this.input.getQuery()||"",t.length>=this.minLength},_updateHint:function(){var t,n,i,r,o,s,u;t=this.menu.getTopSelectable(),n=this.menu.getSelectableData(t),i=this.input.getInputValue(),!n||e.isBlankString(i)||this.input.hasOverflow()?this.input.clearHint():(r=a.normalizeQuery(i),o=e.escapeRegExChars(r),s=new RegExp("^(?:"+o+")(.+$)","i"),u=s.exec(n.val),u&&this.input.setHint(i+u[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return this.isActive()?!0:!this.isEnabled()||this.eventBus.before("active")?!1:(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return this.isActive()?this.eventBus.before("idle")?!1:(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0):!0},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(t){this.input.setQuery(e.toStr(t))},getVal:function(){return this.input.getQuery()},select:function(t){var e=this.menu.getSelectableData(t);return e&&!this.eventBus.before("select",e.obj)?(this.input.setQuery(e.val,!0),this.eventBus.trigger("select",e.obj),this.close(),!0):!1},autocomplete:function(t){var e,n,i;return e=this.input.getQuery(),n=this.menu.getSelectableData(t),i=n&&e!==n.val,i&&!this.eventBus.before("autocomplete",n.obj)?(this.input.setQuery(n.val),this.eventBus.trigger("autocomplete",n.obj),!0):!1},moveCursor:function(t){var e,n,i,r,o;return e=this.input.getQuery(),n=this.menu.selectableRelativeToCursor(t),i=this.menu.getSelectableData(n),r=i?i.obj:null,o=this._minLengthMet()&&this.menu.update(e),o||this.eventBus.before("cursorchange",r)?!1:(this.menu.setCursor(n),i?this.input.setInputValue(i.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",r),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),n}();!function(){"use strict";function r(e,n){e.each(function(){var e,i=t(this);(e=i.data(g.typeahead))&&n(e,i)})}function o(t,e){return t.clone().addClass(e.classes.hint).removeData().css(e.css.hint).css(u(t)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function s(t,e){t.data(g.attrs,{dir:t.attr("dir"),autocomplete:t.attr("autocomplete"),spellcheck:t.attr("spellcheck"),style:t.attr("style")}),t.addClass(e.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!t.attr("dir")&&t.attr("dir","auto")}catch(n){}return t}function u(t){return{backgroundAttachment:t.css("background-attachment"),backgroundClip:t.css("background-clip"),backgroundColor:t.css("background-color"),backgroundImage:t.css("background-image"),backgroundOrigin:t.css("background-origin"),backgroundPosition:t.css("background-position"),backgroundRepeat:t.css("background-repeat"),backgroundSize:t.css("background-size")}}function d(t){var n,i;n=t.data(g.www),i=t.parent().filter(n.selectors.wrapper),e.each(t.data(g.attrs),function(n,i){e.isUndefined(n)?t.removeAttr(i):t.attr(i,n)}),t.removeData(g.typeahead).removeData(g.www).removeData(g.attr).removeClass(n.classes.input),i.length&&(t.detach().insertAfter(i),i.remove())}function f(n){var i,r;return i=e.isJQuery(n)||e.isElement(n),r=i?t(n).first():[],r.length?r:null}var p,g,m;p=t.fn.typeahead,g={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},m={initialize:function(r,u){function d(){var n,d,m,y,v,w,_,b,C,k,S;e.each(u,function(t){t.highlight=!!r.highlight}),n=t(this),d=t(p.html.wrapper),m=f(r.hint),y=f(r.menu),v=r.hint!==!1&&!m,w=r.menu!==!1&&!y,v&&(m=o(n,p)),w&&(y=t(p.html.menu).css(p.css.menu)),m&&m.val(""),n=s(n,p),(v||w)&&(d.css(p.css.wrapper),n.css(v?p.css.input:p.css.inputWithNoHint),n.wrap(d).parent().prepend(v?m:null).append(w?y:null)),S=w?l:c,_=new i({el:n}),b=new a({hint:m,input:n},p),C=new S({node:y,datasets:u},p),k=new h({input:b,menu:C,eventBus:_,minLength:r.minLength},p),n.data(g.www,p),n.data(g.typeahead,k)}var p;return u=e.isArray(u)?u:[].slice.call(arguments,1),r=r||{},p=n(r.classNames),this.each(d)},isEnabled:function(){var t;return r(this.first(),function(e){t=e.isEnabled()}),t},enable:function(){return r(this,function(t){t.enable()}),this},disable:function(){return r(this,function(t){t.disable()}),this},isActive:function(){var t;return r(this.first(),function(e){t=e.isActive()}),t},activate:function(){return r(this,function(t){t.activate()}),this},deactivate:function(){return r(this,function(t){t.deactivate()}),this},isOpen:function(){var t;return r(this.first(),function(e){t=e.isOpen()}),t},open:function(){return r(this,function(t){t.open()}),this},close:function(){return r(this,function(t){t.close()}),this},select:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.select(i)}),n},autocomplete:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.autocomplete(i)}),n},moveCursor:function(t){var e=!1;return r(this.first(),function(n){e=n.moveCursor(t)}),e},val:function(t){var e;return arguments.length?(r(this,function(e){e.setVal(t)}),this):(r(this.first(),function(t){e=t.getVal()}),e)},destroy:function(){return r(this,function(t,e){d(e),t.destroy()}),this}},t.fn.typeahead=function(t){return m[t]?m[t].apply(this,[].slice.call(arguments,1)):m.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=p,this}}()})}).call(e,n(41).setImmediate)},function(t,e,n){(function(t,i){function r(t,e){this._id=t,this._clearFn=e}var o=n(42).nextTick,s=Function.prototype.apply,a=Array.prototype.slice,u={},c=0;e.setTimeout=function(){return new r(s.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new r(s.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},e.setImmediate="function"==typeof t?t:function(t){var n=c++,i=arguments.length<2?!1:a.call(arguments,1);return u[n]=!0,o(function(){u[n]&&(i?t.apply(null,i):t.call(null),e.clearImmediate(n))}),n},e.clearImmediate="function"==typeof i?i:function(t){delete u[t]}}).call(e,n(41).setImmediate,n(41).clearImmediate)},function(t,e){function n(){c=!1,s.length?u=s.concat(u):l=-1,u.length&&i()}function i(){if(!c){var t=setTimeout(n);c=!0;for(var e=u.length;e;){for(s=u,u=[];++l<e;)s&&s[l].run();l=-1,e=u.length}s=null,c=!1,clearTimeout(t)}}function r(t,e){this.fun=t,this.array=e}function o(){}var s,a=t.exports={},u=[],c=!1,l=-1;a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new r(t,e)),1!==u.length||c||setTimeout(i,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=o,a.addListener=o,a.once=o,a.off=o,a.removeListener=o,a.removeAllListeners=o,a.emit=o,a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},,,,,,function(t,e,n){(function(e){function i(t){c(),m=new L.GeoJSON(JSON.parse(t.geometry),{style:y}),f.map.addLayer(m),m.cartodb_id=t.cartodb_id}function r(t){var e,n,i,r="#layer { polygon-fill: #DDDDDD; polygon-opacity: 0.7; line-color: #FFF; line-width: 0.5; line-opacity: 1; } ",o=window.gw.map.coloringConditions.colorized;o&&(r+=a({})),i="latest"===window.gw.map.year?["(data_json::json->>("," SELECT","  json_object_keys(data_json::json) as latest_year"," FROM "+window.gw.environment," WHERE cartodb_id = e.cartodb_id"," ORDER BY 1 DESC"," LIMIT 1","))::float AS data"].join(" "):"(data_json::json->>'"+window.gw.map.year+"')::float AS data",e={cartocss:r,sql:"SELECT *,"+i+", ST_AsGeoJSON(the_geom) AS geometry FROM "+window.gw.environment+" e WHERE  alt_type_slug = '"+t+"'",interactivity:["cartodb_id","slug","alt_type_slug","geometry","data","name"]},f.countySubLayer=f.baseLayer.createSubLayer(e),n=t.toLowerCase(),f.subLayers[n]=f.countySubLayer,p.init(n)}function o(t){var e,n=t.toLowerCase(),i="",r=window.gw.map.coloringConditions.colorized,o={isMarkerLayer:!0},s=g.getColorsFromLegend(t);o.markerFileCss=s.markerFileCss,o.markerFillColorCss=s.markerFillColorCss,o.markerLineColorColorCss=s.markerLineColorColorCss,r?(i+="#layer { "+s.markerFileCss+s.markerLineColorColorCss+" line-color: #FFF; line-width: 0.5; line-opacity: 1; } ",i+=a(o)):i+="#layer { "+s.markerFileCss+s.markerFillColorCss+" line-color: #FFF; line-width: 0.5; line-opacity: 1; } ",e="latest"===window.gw.map.year?["(data_json::json->>("," SELECT","  json_object_keys(data_json::json) as latest_year"," FROM "+window.gw.environment," WHERE cartodb_id = e.cartodb_id AND "," data_json <> 'null'"," ORDER BY 1 DESC"," LIMIT 1","))::float"].join(" "):"(data_json::json->>'"+window.gw.map.year+"')::float",f.subLayers[n]=f.baseLayer.createSubLayer({sql:"SELECT *, "+e+" AS data, GeometryType(the_geom) AS geometrytype FROM "+window.gw.environment+" e WHERE alt_type_slug = '"+t+"' AND "+e+" IS NOT NULL",cartocss:i,interactivity:["cartodb_id","slug","alt_type_slug","geometrytype","data","name"]}),p.init(n)}function s(t){var e,n,i,r=t.toLowerCase(),o=window.gw.map.coloringConditions.colorized,s={isMarkerLayer:!0},u=g.getColorsFromLegend(t);n="latest"===window.gw.map.year?["(data_json::json->>("," SELECT","  json_object_keys(data_json::json) as latest_year"," FROM "+window.gw.environment," WHERE cartodb_id = e.cartodb_id AND","  data_json <> 'null'"," ORDER BY 1 DESC"," LIMIT 1","))::float"].join(" "):"(data_json::json->>'"+window.gw.map.year+"')::float",i=["SELECT"," actual_geom as the_geom_webmercator,"," cartodb_id,"," name,"," alt_type_slug,"," slug,",n+" AS data","FROM "+window.gw.environment+" e","WHERE "+n+" IS NOT NULL"],s.markerFileCss=u.markerFileCss,s.markerFillColorCss=u.markerFillColorCss,s.markerLineColorColorCss=u.markerLineColorColorCss,e="#layer { "+u.markerFileCss+u.markerFillColorCss+" line-color: #FFF; line-width: 0.5; line-opacity: 1; } ",o&&(e+=a(s)),f.subLayers[r]=f.baseLayer.createSubLayer({sql:i.join(" "),cartocss:e,interactivity:["cartodb_id","name","alt_type_slug","slug","data"]}),p.init(r)}function a(t){var e="",n="",i=window.gw.map.coloringConditions.conditions;return n+=g.getPeriodConditionsAsCss(i,t),n+=g.getSimpleConditionsAsCss(i,t),n+=g.getNullConditionAsCss(i,t),""===n&&(console.warn("Can't find any condition, please verify your window.gw.map.coloringConditions.conditions data"),console.warn("or check getPeriodConditionsAsCss, getSimpleConditionsAsCss, getNullConditionAsCss functions")),e+=n}function u(){var t,n,r=[];for(t in f.subLayers)f.subLayers.hasOwnProperty(t)&&(n=f.subLayers[t],n.setInteraction(!0),n.bind("mouseover",function(t,n,o,s,a){r[a]=1,_.some(r)&&(e(".leaflet-container").css("cursor","pointer"),f.countySubLayer&&a===f.countySubLayer._position?i(s):c(),_.forOwn(f.tooltips,function(t){null!==t&&(t.getLayerIndex()===a?t.enable():t.disable())}))}),n.bind("mouseout",function(t){r[t]=0,_.some(r)||(e(".leaflet-container").css("cursor","auto"),c(),_.forOwn(f.tooltips,function(e){null!==e&&e.getLayerIndex()===t&&e.disable()}))}),n.on("featureClick",function(t,e,n,i){var r;return i.alt_type_slug&&i.slug?(r=window.location.pathname,"/"!==r[r.length-1]&&(r+="/"),window.location.href=r+i.alt_type_slug+"/"+i.slug+"?year="+window.gw.map.year,!0):(alert("Please verify your data, altTypeSlug or governmentSlug may can not defined, more info in console.log"),!0)}))}function c(){f.map.removeLayer(m),m.cartodb_id=null}function l(){var t;c();for(t in f.subLayers)f.subLayers.hasOwnProperty(t)&&f.subLayers[t].remove()}function h(t){var e=t.filter(function(t){return"MULTIPOLYGON"===t.geometrytype||"POLYGON"===t.geometrytype}),n=t.filter(function(t){return"MULTIPOLYGON"!==t.geometrytype&&"POLYGON"!==t.geometrytype});e.forEach(function(t){r(t.alt_type_slug)}),-1!==window.gw.environment.indexOf("cmf")?n.forEach(function(t){s(t.alt_type_slug)}):n.forEach(function(t){o(t.alt_type_slug)}),u()}function d(t){var e;t&&(window.gw.map.coloringConditions.conditions=t.conditions.length>0?t.conditions:f.defaultConditions),e=f.layersData.rows.filter(function(t){return!!t.alt_type_slug}),h(e),p.initTooltips()}var f=n(49),p=n(51),g=n(52),m={},y={color:"#808080",weight:1,opacity:1,fillOpacity:.6,fillColor:"#000000",clickable:!1};t.exports={initCountySubLayer:r,initMarkerSubLayer:o,initCmfMarkerSublayer:s,initSublayerHandlers:u,removeAllHoverShapes:c,removeAllSubLayers:l,initSubLayers:h,reInit:d}}).call(e,n(1))},function(t,e,n){var i,r,o,s,a,u,c,l={},h={},d=n(50);d.isTest||(window.gw.map=JSON.parse(window.gw.map),u=JSON.parse(JSON.stringify(window.gw.map.coloringConditions)),r=window.gw.map.legend.sort(function(t,e){return t.order>e.order}),c=window.localStorage.getItem("debug")),t.exports={map:i,legend:r,baseLayer:o,countySubLayer:s,subLayers:l,layersData:a,tooltips:h,defaultConditions:u,debug:c}},function(t,e){(function(e){t.exports={isTest:"function"==typeof e.it}}).call(e,function(){return this}())},function(t,e,n){(function(e){function i(t){var e='<div class="cartodb-tooltip-content-wrapper"> <div class="cartodb-tooltip-content"></p>';e+=o.debug?"<p>{{name}} ({{data}})</p>":"<p>{{name}} {{#dataFormatted}} ({{dataFormatted}}) {{/dataFormatted}} </p>",e+="</div></div>",o.tooltips[t]=new cdb.geo.ui.Tooltip({layer:o.subLayers[t],template:e,width:200,position:"bottom|right"}),window.gw.map.coloringConditions.field_mask&&o.tooltips[t].setMask(window.gw.map.coloringConditions.field_mask.mask)}function r(){var t=e("#map_wrap"),n=t.find("cartodb-tooltip");0!==n.length&&n.remove(),_.forOwn(o.tooltips,function(t){e("#map_wrap").append(t.render().el)})}var o=n(49);t.exports={init:i,initTooltips:r}}).call(e,n(1))},function(t,e,n){(function(e){function i(t,e){var n,i,r,o,s="",u=a(t,"period");return t?(0!==u.length&&u.forEach(function(t){var a=e.isMarkerLayer?"marker-fill":"polygon-fill",u=e.isMarkerLayer?t.color:t.color,c=e.markerFileCss?e.markerFileCss:"",l=a+": "+u+";"+c,h=e.isMarkerLayer?"marker-line-color":"line-color",d=e.isMarkerLayer?t.color:"#FFFFFF",f=h+": "+d+";";e.markerLineColorColorCss&&(f=e.markerLineColorColorCss),n=e.isMarkerLayer?"marker-line-width: 1;":"line-width: 0.5;",i="[data >= "+t.min+"]",r="[data <= "+t.max+"]",o="{ "+l+f+n+" line-opacity: 1; polygon-opacity: 0.3; } ",s+="#layer"+i+r+o}),s||""):(console.warn("You don't pass condition array into getPeriodConditionsAsCss() function"),"")}function r(t,n){var i,r,o,s,u,c,l,h,d,f,p,g,m;return t?(i=e.extend({},n),r="",o=a(t,"simple"),0!==o.length&&(o.sort(function(t,e){return t.value<e.value}),o.forEach(function(t){s=i.isMarkerLayer?"marker-fill":"polygon-fill",u=i.isMarkerLayer?t.color:t.color,c=i.markerFileCss?i.markerFileCss:"",l=s+": "+u+"; "+c,h=i.isMarkerLayer?"marker-line-color":"line-color",d=i.isMarkerLayer?t.color:"#FFFFFF",f=h+": "+d+";",i.markerLineColorColorCss&&(f=i.markerLineColorColorCss),p=i.isMarkerLayer?"marker-line-width: 1;":"line-width: 0.5;",g="[data "+t.operation+" "+t.value+"]",m="{ "+l+f+p+" line-opacity: 1; polygon-opacity: 0.3; } ",r+="#layer"+g+m})),r||""):(console.warn("You don't pass condition array into getSimpleConditionsAssCss() function"),"")}function o(t,n){var i,r,o,s,u,c,l,h,d,f=e.extend({},n),p="",g=a(t,"null");return t?(0!==g.length&&(i=f.isMarkerLayer?"marker-fill":"polygon-fill",r=f.isMarkerLayer?g[0].color:g[0].color,o=f.markerFileCss?f.markerFileCss:"",s=i+": "+r+";"+o,u=f.isMarkerLayer?"marker-line-color":"line-color",c=f.isMarkerLayer?g[0].color:"#FFFFFF",l=u+": "+c+";",f.markerLineColorColorCss&&(l=f.markerLineColorColorCss),h=f.isMarkerLayer?"marker-line-width: 1;":"line-width: 0.5;",d="{ "+s+l+h+" line-opacity: 1; polygon-opacity: 0.3; } ",p+="#layer[data = null]"+d),p||""):(console.warn("You don't pass condition array into getNullConditionAsCss() function"),"")}function s(t){var e,n,i,r,o;return(e=u.legend.filter(function(e){return e.altType===t})[0])?(n=u.debug?"http://california.govwiki.freedemster.com":window.location.href.substr(0,window.location.href.length-1),e.color||e.shape?(i="marker-file: url("+n+e.shape+");",r="marker-fill: "+e.color+"; ",o="marker-line-color: "+e.color+"; "):(console.error("Legend not contain style properties, please fix it !!!"),i="",r="",o=""),{markerFileCss:i,markerFillColorCss:r,markerLineColorColorCss:o}):!1}function a(t,e){return t.filter(function(t){return t.type===e})}var u=n(49);t.exports={getPeriodConditionsAsCss:i,getSimpleConditionsAsCss:r,getNullConditionAsCss:o,getConditionsByType:a,getColorsFromLegend:s}}).call(e,n(1))},function(t,e,n){(function(t){function e(e){function n(e){var n,s,a,u=t("#map"),c=t("#map_wrap").find(".loader");e.on("load",function(){c.hide(),u.show(),u.css({opacity:1})}),o.baseLayer=e,n=new cartodb.SQL({user:window.gw.map.username}),s="SELECT GeometryType(the_geom), alt_type_slug FROM "+window.gw.environment,a="WHERE the_geom IS NOT NULL GROUP BY GeometryType(the_geom), alt_type_slug ORDER BY alt_type_slug",n.execute(s+" "+a).done(function(t){o.layersData=t,r(t)}).error(function(t){return i(t)})}var s={user_name:window.gw.map.username,type:"cartodb",sublayers:[]};e instanceof cartodb.vis.Vis?(e.createLayer(s),n(e.getLayers()[1])):e.createLayer(o.map,s).addTo(o.map).done(n)}function i(){var e=t(".mapOnProcessing");e.find("h5").eq(0).text("Something went wrong, please contact with us (contact@californiapolicycenter.org) "),e.css({opacity:1}),e.show()}function r(t){function e(t){return _.forOwn(window.gw.map.legendTypes,function(e){return e===t})[0]}var n,i=t.rows.filter(function(t){return!!t.alt_type_slug});s.initSubLayers(i),c.initTooltips(),n=!1,e("altTypes")&&(a.init(i),n=!0),e("range")&&u.init(!n)}n(54),n(49),n(55),n(56),n(57);var o=n(49),s=n(48),a=n(58),u=n(59),c=n(51);-1!==window.gw.environment.indexOf("cmf")?cartodb.createVis("map","https://joffemd.carto.com/api/v2/viz/8671cd00-dc75-11e6-9a78-0e3ebc282e83/viz.json",{zoomControl:!0,scrollWheel:!0,center:[window.gw.map.centerLatitude,window.gw.map.centerLongitude],zoom:window.gw.map.zoom}).done(function(t){o.map=t.getNativeMap(),e(t)}):(o.map=L.map("map",{zoomControl:!0,center:[window.gw.map.centerLatitude,window.gw.map.centerLongitude],zoom:window.gw.map.zoom}),L.tileLayer("http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png",{attribution:"GovWiki"}).addTo(o.map),e(cartodb))}).call(e,n(1))},function(t,e){},function(t,e,n){(function(t){var e;cdb.geo.ui.Tooltip.prototype.getLayerIndex=function(){return this.options.layer._position},cdb.geo.ui.Tooltip.prototype.setMask=function(t){return this.options.gw={mask:t},this},e=cdb.geo.ui.Tooltip.prototype.render,cdb.geo.ui.Tooltip.prototype.render=function(n){var i=t.extend({},n);return null!==i.data&&void 0!==i.data&&this.options.gw.mask&&(i.dataFormatted=numeral(i.data).format(this.options.gw.mask)),e.call(this,i)}}).call(e,n(1))},function(t,e,n){(function(t){var e,i=n(15),r=750,o=function(n,i,o){e&&clearTimeout(e),e=setTimeout(function(){t.ajax({method:"GET",url:window.gw.urls.search_elected+"?search="+n}).success(function(t){o(t)})},r)},s="",a=t(".typeahead_elected").typeahead({hint:!0,highlight:!0,minLength:3},{name:"elected_officials",source:o,templates:{empty:'<div class="tt-suggestion">Not found. Please retype your query </div>',suggestion:i.compile('<div class="sugg-box"><div class="sugg-name">{{fullName}}</div><div class="sugg-govname">{{government.name}}</div></div>')},updater:function(t){alert(t)}});a.bind("typeahead:selected",function(t,e){a.typeahead("val",e.fullName),window.location.pathname+=[e.government.altTypeSlug,e.government.slug,e.slug].join("/")}),a.bind("typeahead:cursorchange",function(){a.typeahead("val",s)}),a.bind("keyup",function(){a.val().length<3&&clearTimeout(e)}),a.keyup(function(e){s=t(e.target).val()}),a.attr("placeholder","ELECTED OFFICIAL NAME"),a.attr("disabled",!1)}).call(e,n(1))},function(t,e,n){(function(t){var e,i=n(15),r=750,o=function(n,i,o){e&&clearTimeout(e),e=setTimeout(function(){t.ajax({method:"GET",url:window.gw.urls.search_government+"?search="+n}).success(function(t){o(t)})},r)},s="",a=t(".typeahead_government").typeahead({hint:!0,highlight:!0,minLength:3},{name:"countries",source:o,templates:{empty:'<div class="tt-suggestion">Not found. Please retype your query </div>',suggestion:i.compile('<div class="sugg-box"><div class="sugg-state">{{state}}</div><div class="sugg-name">{{name}}</div></div>')},updater:function(t){alert(t)}});a.bind("typeahead:selected",function(t,e){a.typeahead("val",e.name),window.location.pathname+=[e.altTypeSlug,e.slug].join("/")}),a.bind("typeahead:cursorchange",function(){a.typeahead("val",s)}),a.bind("keyup",function(){a.val().length<3&&clearTimeout(e)}),a.keyup(function(e){s=t(e.target).val()}),a.attr("disabled",!1)}).call(e,n(1))},function(t,e,n){(function(e){function i(){var t=e("#menu"),n="";o.legend.length<2||(o.legend.forEach(function(t){var e,i="",r="",o="",s="";e=t.altType.toLowerCase(),window.gw.map.coloringConditions.colorized?t.shape?(o='fillColor="white" ',s='strokeColor="'+t.color+'" ',r='<img src="'+t.shape+'" class="svg" '+s+o+"/>"):i='<i class="grey-line"></i>':t.shape?(o='fillColor="'+t.color+'" ',s='strokeColor="'+t.color+'" ',r='<img src="'+t.shape+'" class="svg" '+s+o+"/>"):i='<i class="grey-line"></i>',n+="<li id="+e+' class="'+e+' legend-item selected"><span class="glyphicon glyphicon-ok"></span>'+i+r+'<a href="javascript:void(0)">'+t.title+"</a></li>"}),t.append(n).css({opacity:1}),r(),t.on("click",".legend-item",function(){var t;e(this).toggleClass("selected"),t=e(this).attr("id"),o.subLayers[t].toggle()}))}function r(){e("img.svg").each(function(){var t=e(this),n=t.attr("id"),i=t.attr("class"),r=t.attr("src"),o=t.attr("fillColor"),s=t.attr("strokeColor");e.get(r,function(r){var a=e(r).find("svg"),u=a.find("rect"),c=a.find("path");void 0!==u[0]&&u.css({fill:o,stroke:s}),void 0!==c[0]&&c.css({fill:o,stroke:s}),void 0!==typeof n&&(a=a.attr("id",n)),void 0!==typeof i&&(a=a.attr("class",i+" replaced-svg")),a=a.removeAttr("xmlns:a"),t.replaceWith(a)},"xml")})}var o=n(49);t.exports={init:i}}).call(e,n(1))},function(t,e,n){(function(e){function i(t){var n,i,o,s="cartodb-legend-stack",a="",u=window.gw.map.coloringConditions.localized_name,c=window.gw.map.coloringConditions.conditions;return window.gw.map.coloringConditions.colorized?(c.forEach(function(t){switch(i="background: "+t.color,t.type){case"period":o=t.min+" - "+t.max;break;case"simple":o=t.operation+" "+t.value;break;case"null":o="null";break;default:console.warn("Invalid condition type.")}a+='<li data-condition="'+JSON.stringify(t).replace(/"/g,"&quot;")+'"><div class="bullet" style="'+i+'"></div>'+o+"</li>"}),t&&(s+=" cartodb-legend-stack__top"),n=e('<div class="'+s+'" style=""><div class="cartodb-legend custom horizontal" style="display: block;"><div class="legend-title">'+u+"</div><ul>"+a+"</ul></div></div>"),e("#menu").after(n),r(n),!0):!1}function r(t){var n,i,r=[],l=[];t.on("click","li",function(){var t=e(this),h=t.hasClass("active");l=[],n=JSON.parse(e(this).attr("data-condition")),h?o(r,n):s(r,n),r.length>0?(i=c(r,f.defaultConditions.conditions),a(l,r),u(l,i)):l=f.defaultConditions.conditions,p.removeAllSubLayers(),p.reInit({conditions:l}),t.toggleClass("active")})}function o(t,e){var n=l(t,e);return-1!==n&&t.splice(n,1),n}function s(t,e){return t.push(e)}function a(t,e){e.forEach(function(e){t.push(e)})}function u(t,e){_.forEach(e,function(e){var n=_.assign({},e);n.color="#dddddd",t.push(n)})}function c(t,e){return e.filter(function(e){return-1===l(t,e)})}function l(t,e){var n=null;return t?(t.length>0&&t.forEach(function(t,i){"simple"===e.type&&e.type===t.type?t.operation===e.operation&&t.value===e.value&&(n=i):"period"===e.type&&e.type===t.type?t.min===e.min&&t.max===e.max&&(n=i):"null"===e.type&&e.type===t.type&&t.color===e.color&&(n=i)}),null!==n?n:-1):-1}var h,d=n(50),f=n(49),p=n(48);h={init:i},d.isTest&&(h={findDisabledConditions:c,addDisabledConditions:u,addActiveConditions:a,addActiveCondition:s,removeActiveCondition:o}),t.exports=h}).call(e,n(1))}]);