{% import _self as fun %}
<div role="tabpanel" class="tab-pane" id="Endorsements">

    <table class="table table-hover" data-entity-type="Endorsement">
        <tr>
            <th>Election Year</th>
            <th>Name</th>
            <th>Type</th>
            <th></th>
        </tr>

        {% if (elected.endorsements is defined) and (elected.endorsements is not empty) %}

            {% for endorsement in elected.endorsements %}

                <tr data-id="{{endorsement.id}}">
                    <td data-election-year="{{endorsement.electionYear}}">
                        <a data-type="text"
                           data-placeholder="Please edit" data-title="Please edit"
                           class="editable editable-pre-wrapped editable-click" data-original-title="">{{endorsement.electionYear}}<span class="glyphicon glyphicon-pencil edit"></span></a>
                    </td>
                    <td data-name-of-endorser="{{endorsement.nameOfEndorser}}">
                        <a href="javascript:void(0);" data-type="textarea"
                           data-placeholder="Please edit" data-title="Please edit"
                           class="editable editable-pre-wrapped editable-click" data-original-title="">{{endorsement.nameOfEndorser}}</a>
                        <span class="glyphicon glyphicon-pencil edit"></span>
                    </td>
                    <td data-endorser-type="{{endorsement.endorserType}}">
                        <a href="javascript:void(0);" data-type="select" data-pk="1" data-source="{'Elected Official': 'Elected Official', 'Organization': 'Organization', 'Political Party': 'Political Party', 'Union': 'Union', 'Other': 'Other'}" data-placeholder="Please edit" data-title="Please edit"
                           class="editable editable-pre-wrapped editable-click" data-original-title="">{{endorsement.endorserType}}</a>
                        <span class="glyphicon glyphicon-pencil edit"></span>
                    </td>
                    <td>

                    </td>
                </tr>

            {% endfor %}

            {% if app.user and (createRequests is defined) %}
                {{ fun.renderNewEndorsements(createRequests, categories) }}
            {% endif %}

        {% elseif app.user and (createRequests is defined) %}

            {{ fun.renderNewEndorsements(createRequests, categories) }}

        {% else %}

            <tr>
                <td colspan="7" align="center">
                    <p style="font-size:18px;">No information at this time. Please check back later.</p>
                </td>
            </tr>

        {% endif %}

        <tr class="add_action">
            <td colspan="7" class="add">
                Add new Endorsement
                <span class="glyphicon glyphicon-plus"></span>
            </td>
        </tr>
    </table>

</div>

{% macro renderNewEndorsements(createRequests, categories) %}

    {% for createRequest in createRequests %}
        {% if createRequest.entityName == 'Endorsement' and createRequest.fields.fields.electionYear is defined %}
            <tr data-id="{{ createRequest.id }}" style="background: rgba(80, 0, 0, 0.1)">
                <td data-election-year="{{ createRequest.fields.fields.electionYear }}">
                    {{ createRequest.fields.fields.electionYear }}
                </td>
                <td data-name-of-endorser="{{ createRequest.fields.fields.nameOfEndorser }}" data-no-editable>
                    {{ createRequest.fields.fields.nameOfEndorser }}
                </td>
                <td data-endorser-type="{{ createRequest.fields.fields.endorserType }}" data-no-editable>
                    {{ createRequest.fields.fields.endorserType }}
                </td>

                {% set username = '' %}
                {% if createRequest.fields.fields.username is defined %}
                    {% set username = createRequest.fields.fields.username %}
                {% endif %}
                <td data-username="{{ username }}" data-no-editable>{{ username }}</td>
            </tr>
        {% endif %}
    {% endfor %}

{% endmacro %}