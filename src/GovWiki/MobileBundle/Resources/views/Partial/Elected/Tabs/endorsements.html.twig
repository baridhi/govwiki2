{% import 'GovWikiMobileBundle:Partial/Elected/Tabs:macro.html.twig' as macro %}
{% import _self as helper %}

<div role="tabpanel" class="tab-pane" id="Endorsements">
    <div class="tab-pane-main">

        <div class="add_action">
            <span>Add new Endorsement</span>
            <span class="glyphicon glyphicon-plus"></span>
        </div>

        {{ knp_pagination_render(endorsements) }}

        {%- for endorsement in endorsements -%}
            {% set blockId = 'endorsementCollapse' ~ loop.index %}

            {# Card #}
            <div class="card">

                {# Header #}
                <div class="card__header text-justify" data-toggle="collapse"
                     data-target="#{{ blockId }}" aria-expanded="false"
                     aria-controls="{{ blockId }}">

                    <p class="card__header-title" {%-
                        if macro.isPendingRequest(endorsement)
                    -%}
                        style="background: rgba(80, 0, 0, 0.1)"
                    {%- endif -%}>
                        {{- endorsement.nameOfEndorser -}}
                    </p>

                    <div class="card__group card__group_offset">
                        <span class="card__group-item">
                            Election Year:
                            <span>{{- endorsement.electionYear -}}</span>
                        </span>

                        <span class="card__group-item card__group-item_right">
                            Type:
                            <span>{{- endorsement.endorserType -}}</span>
                        </span>
                    </div>

                    {# Expand icon #}
                    <div class="card__header-expand" data-toggle="collapse" data-target="#{{ blockId }}" aria-expanded="false"
                         aria-controls="{{ blockId }}">
                        <i class="glyphicon glyphicon-chevron-down"></i>
                    </div>
                </div>

                {# Content (Collapsable) #}
                <div class="collapse" id="{{ blockId }}">
                    <div class="card__block">
                        {# Legislation info #}
                        <h4 class="card__block-title">
                            {{- helper.nameOfEndorser(endorsement) -}}
                        </h4>

                        {# How legislation vote (as table) #}
                        <table class="table table-stripped">
                            <tr>
                                <th>Election Year</th>
                                <td>{{ helper.electionYear(endorsement) }}</td>
                            </tr>
                            <tr>
                                <th>Type</th>
                                <td>{{ helper.endorserType(endorsement) }}</td>
                            </tr>
                        </table>

                        {% if not macro.isPendingRequest(endorsement) %}
                            {# Comment icon #}
                            <p class="card__block-footer">
                                <a href="#"><i class="glyphicon glyphicon-comment"></i> 0</a>
                            </p>
                        {% endif %}

                    </div>
                </div>
            </div>
        {%- endfor -%}

    </div>
</div>

{%- macro electionYear(endorsement) -%}
    {% import 'GovWikiMobileBundle:Partial/Elected/Tabs:macro.html.twig' as macro %}
    <div data-election-year="{{ endorsement.electionYear }}"
         style="display: inline-block">
        {%- if macro.isPendingRequest(endorsement) -%}
            {{- environment.electionYear -}}
        {%- else -%}
            <a href="javascript:void(0);" data-type="text" data-pk="1"
               data-placeholder="Please edit" data-title="Please edit"
               class="editable editable-pre-wrapped editable-click" data-original-title=""
               title="">
                {{- endorsement.electionYear -}}
                <span class="glyphicon glyphicon-pencil edit"></span>
            </a>
        {%- endif -%}
    </div>
{%- endmacro -%}

{%- macro nameOfEndorser(endorsement) -%}
    {% import 'GovWikiMobileBundle:Partial/Elected/Tabs:macro.html.twig' as macro %}
    <div data-name-of-endorser="{{ endorsement.nameOfEndorser }}"
         style="display: inline-block">
        {%- if macro.isPendingRequest(endorsement) -%}
            {{- endorsement.nameOfEndorser -}}
        {%- else -%}
            <a href="javascript:void(0);" data-type="textarea" data-pk="1"
               data-placeholder="Please edit" data-title="Please edit"
               class="editable editable-pre-wrapped editable-click"
               data-original-title=""
               title="">
                {{- endorsement.nameOfEndorser -}}
                <span class="glyphicon glyphicon-pencil edit"></span>
            </a>
        {%- endif -%}
    </div>
{%- endmacro -%}

{%- macro endorserType(endorsement) -%}
    {% import 'GovWikiMobileBundle:Partial/Elected/Tabs:macro.html.twig' as macro %}
    <div data-endorser-type="{{ endorsement.endorserType }}" style="display: inline-block">
        {%- if macro.isPendingRequest(endorsement) -%}
            {{- endorsement.endorserType -}}
        {%- else -%}
            <a href="javascript:void(0);" data-type="select" data-pk="1"
               data-placeholder="Please edit" data-title="Please edit"
               class="editable editable-pre-wrapped editable-click"
               data-original-title=""
               data-source="{'Elected Official': 'Elected Official', 'Organization': 'Organization', 'Political Party': 'Political Party', 'Union': 'Union', 'Other': 'Other'}"
               title="">
                {{- endorsement.endorserType -}}
                <span class="glyphicon glyphicon-pencil edit"></span>
            </a>
        {%- endif -%}
    </div>
{%- endmacro -%}