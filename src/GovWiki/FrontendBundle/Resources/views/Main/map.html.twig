{% extends "GovWikiFrontendBundle:Layout:main.html.twig" %}

{% block main %}

    <section class="mapController">

        <div class="row">
            {# Typeahead Search #}
            <div class="typeahead_wrap col-md-6 col-lg-5">
                <input id="search_government" type="text" placeholder="Loading the list of governments"
                       class="text-uppercase typeahead_government form-control" disabled>
            </div>
            <div class="typeahead_wrap col-md-6 col-lg-5">
                <input id="search_elected" type="text" placeholder="Loading the list of elected officials"
                       class="text-uppercase typeahead_elected form-control" disabled>
            </div>

            <div class="col-md-6 col-lg-5">
                <p class="text-center text-nowrap hidden-xs hidden-sm">
                    Type part of the agency's name
                    <img src="{{ asset('bundles/govwikifrontend/img/ArrowUp.gif') }}" style="width:40px">
                    or click it on the map
                    <img src="{{ asset('bundles/govwikifrontend/img/ArrowDown.gif') }}" style="width:40px">
                </p>
            </div>
            <div class="col-md-6 col-lg-5">
                <p class="text-nowrap hidden-xs hidden-sm" style="margin-left: 8%">
                    Type part of the agency's name
                    <img src="{{ asset('bundles/govwikifrontend/img/ArrowUp.gif') }}" style="width:40px">
                </p>
            </div>
        </div>

        <div class="row">

            <div class="col-sm-12 col-md-6 col-lg-5">

                {# Map wrapper #}
                <div id="map_wrap">

                    {# Preloader #}
                    <div class="loader"></div>

                    {# Notification message#}
                    <div class="mapOnProcessing">
                        <h5>Please wait, map recently created</h5>
                        <h5>Please refresh page later</h5>
                    </div>

                    {# Legend #}
                    <ul id='menu'>

                        <li class="legend-header">
                            <span>Select type(s):</span>
                        </li>

                        <li id="cities" class="legend-item cities selected">
                            <span class="glyphicon glyphicon-ok"></span>
                            <i class="red-circle marker-circle"></i>
                            <a href="javascript:void(0)">Cities</a>
                        </li>

                        <li id="counties" class="legend-item counties selected">
                            <span class="glyphicon glyphicon-ok"></span>
                            <i class="grey-line"></i>
                            <a href="javascript:void(0)">Counties</a>
                        </li>

                        <li id="school" class="legend-item school selected">
                            <span class="glyphicon glyphicon-ok"></span>
                            <i class="blue-circle marker-circle"></i>
                            <a href="javascript:void(0)">School Districts</a>
                        </li>

                        <li id="special" class="legend-item special selected">
                            <span class="glyphicon glyphicon-ok"></span>
                            <i class="purple-circle marker-circle"></i>
                            <a href="javascript:void(0)">Special Districts</a>
                        </li>

                    </ul>

                    {# Map #}
                    <div id="map"></div>

                </div>

            </div>

            {# Intro text #}
            <div class="col-sm-12 col-md-6 col-lg-7">

                <div class="intro-text">
                    {{- greetingText|raw -}}
                </div>

            </div>

        </div>

    </section>

{% endblock %}


{# Stylesheets #}
{% block stylesheets %}

    {{parent()}}

    {% stylesheets '@GovWikiFrontendBundle/Resources/public/css/map.scss' filter='scss, cssrewrite' %}
    <link rel="stylesheet" href="{{ asset_url }}">
    {% endstylesheets %}

{% endblock %}


{# Javascripts #}
{% block javascripts %}

    {{parent()}}

    <script src="https://cartodb-libs.global.ssl.fastly.net/cartodb.js/v3/3.13/cartodb.js"></script>

    <script>
        window.gw.map = '{{ map | raw }}';
        window.gw.environment = '{{ environment }}';
        window.gw.urls = {};
        window.gw.urls.search_government = '{{ govwiki_path('govwiki_api_v1_government_search') }}';
        window.gw.urls.search_elected = '{{ govwiki_path('govwiki_api_v1_electedofficial_search') }}';
    </script>

    {% javascripts  '@GovWikiFrontendBundle/Resources/public/js/vendor/handlebars.js'
                    '@GovWikiFrontendBundle/Resources/public/js/vendor/typeahead.js'
                    '@GovWikiFrontendBundle/Resources/public/js/script.js'
                    '@GovWikiFrontendBundle/Resources/public/js/home/search_government.js'
                    '@GovWikiFrontendBundle/Resources/public/js/home/search_elected.js'
                    '@GovWikiFrontendBundle/Resources/public/js/home/map.js'
                    '@GovWikiFrontendBundle/Resources/public/js/home/index.js'
                    output='js/map.js' %}
        <script src="{{ asset_url }}"></script>
    {% endjavascripts %}

{% endblock %}
